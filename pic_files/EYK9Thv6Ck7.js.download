;/*FB_PKG_DELIM*/

__d("EBBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";b={getContactEpochHead:(a=d("IEBAPI")).makeBridgedApi("getContactEpochHead"),getMessageKeys:a.makeBridgedApi("getMessageKeys"),isEbEnabledEbSwitch:a.makeBridgedApi("isEbEnabledEbSwitch"),messageBulkPointQuery:a.makeBridgedApi("messageBulkPointQuery"),messageRangeQueryForIndexing:a.makeBridgedApi("messageRangeQueryForIndexing")};c=b;g["default"]=c}),98);
__d("FDSPhotoDownloadFilled16Icon",["cr:15408"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15408")}),98);
__d("FDSPhotoDownloadFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("1873235"),16);b=a;g["default"]=b}),98);
__d("FDSPhotoDownloadFilled20Icon",["cr:15409"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15409")}),98);
__d("FDSPhotoDownloadFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("1433212"),20);b=a;g["default"]=b}),98);
__d("LSFetchFtsThreads",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("timestamp",a[0]),d[0].set("session_id",a[1]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"fts_thread_fetch",c.i64.cast([0,760]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSFTSThreadsFetchFtsThreadsStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSFetchFtsThreadsStoredProcedure",["LSFetchFtsThreads","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSFetchFtsThreads"),e.timestamp,e.sessionId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[5]=b.syncGroup,c.i64.neq(d[5],void 0)?d[4]=d[5]:d[4]=c.i64.cast([0,1]),d[0]=d[4])})},function(a){return c.storedProcedure(b("LSGetCursor"),d[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",f.minTimestampMs),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure";a.__tables__=["threads","attachments_ranges_v2__generated"];e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueAttachmentsRangeQuery"),e.threadKey,e.mediaGroup);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("ThreadsDoublyLinkedList",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){this.value=a};a=function(){function a(){this.$1=new Map(),this.$2=null,this.$3=null}var b=a.prototype;b.getHead=function(){if(this.$2!=null)return this.$2.value};b.has=function(a){return this.$1.has(a)};b.size=function(){return this.$1.size};b.insertToHead=function(a){if(this.getHead()===a)return;this.has(a)&&this.remove(a);this.$2==null?this.add(a):(this.$2.prev=new g(a),this.$2.prev.next=this.$2,this.$2=this.$2.prev,this.$1.set(a,this.$2))};b.add=function(a){if(this.has(a))return;if(!this.$2){this.$2=new g(a);this.$3=this.$2;this.$1.set(a,this.$2);return}this.$3!=null&&(this.$3.next=new g(a),this.$3.next.prev=this.$3,this.$3=this.$3.next,this.$1.set(a,this.$3))};b.remove=function(a){var b=this.$1.get(a);if(b==null)return;b.prev!=null&&(b.prev.next=b.next);b.next!=null&&(b.next.prev=b.prev);b===this.$2&&(this.$2=b.next);b===this.$3&&(this.$3=b.prev);this.$1["delete"](a)};return a}();f["default"]=a}),66);
__d("MAWFTSThreadsRestore",["FBLogger","I64","LSDatabaseSingleton","LSFactory","LSFetchFtsThreadsStoredProcedure","LSMessagingThreadTypeUtil","MAWBridgeSendAndReceive","MAWFTSRestoreCap","MAWFTSRestoreSyncLogger","MAWJids","ReQL","ThreadsDoublyLinkedList","WAJids","emptyFunction","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=function(){function a(){this.$1=new Map(),this.$4=!1,this.$5=(h||(h=d("I64"))).zero,this.$6=!1,this.$7=new Set(),c("FBLogger")("messenger_web").info("New MAWFTSThreadsRestore instance"),this.$2=new(c("ThreadsDoublyLinkedList"))()}var b=a.prototype;b.startThreadsRestore=async function(){if(this.$4)return;this.$4=!0;this.$6=!0;await d("MAWFTSRestoreSyncLogger").initLoggingSessionId();await this.$8();await this.$9()};b.isThreadQueryInProgress=function(){return this.$6||this.$7.size>0};b.getInitialLastActivityTimeForThreadMs=function(a){return this.$1.get(a)};b.getThreadsHead=function(){return this.$2.getHead()};b.hasThread=function(a){return this.$2.has(a)};b.insertIntoHead=function(a){this.$2.insertToHead(a)};b.removeThread=function(a){this.$2.remove(a)};b.$10=function(a,b){d("MAWFTSRestoreSyncLogger").onFetchThreadsPageStart(),void a.runInTransaction(function(a){return c("LSFetchFtsThreadsStoredProcedure")(c("LSFactory")(a),{sessionId:"",timestamp:b})},"readwrite",void 0,void 0,f.id+":123")};b.$11=function(a,b,e){e===void 0&&(e=c("emptyFunction"));this.$6=!0;var f=b.hasNextPage,g=b.nextPageCursor;b=b.resultCount;b=(h||(h=d("I64"))).to_int32(b);var i=!h.equal(g,this.$5),j=d("MAWFTSRestoreCap").isRestoreTimeWithinCap(h.to_float(g));i&&d("MAWFTSRestoreSyncLogger").onFetchThreadsPageComplete(b);f&&j?i&&(this.$5=g,this.$10(a,g)):(this.$6=!1,this.$7.size===0&&d("MAWFTSRestoreSyncLogger").onFetchThreadsComplete(),e())};b.$8=async function(){var a=this,b=await this.$12(),c=d("ReQL").fromTableAscending(b.tables.messenger_fts_threads_queries,["hasNextPage","nextPageCursor","resultCount"]),e={contents:function(){}};e.contents=c.subscribe(function(c,d){if(d.operation==="delete")return;a.$11(b,d.value,e.contents)});c=await d("ReQL").firstAsync(c);c?this.$11(b,c):this.$10(b,(h||(h=d("I64"))).max_int)};b.$13=function(a){var b=this,e=a.nextMessageTimestamp,f=a.threadId;a=a.threadType;f=(h||(h=d("I64"))).to_string(f);a=d("LSMessagingThreadTypeUtil").isGroup(a);var g=a?d("WAJids").toGroupJid(f):d("MAWJids").toUserJid(f);this.$7.add(g);c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend","searchGetFTSNextTimestamp",{threadId:g}).then(function(a){var c=(h||(h=d("I64"))).to_float(e);if(!d("MAWFTSRestoreCap").isRestoreTimeWithinCap(c))return;if(!b.$1.has(g)){b.$1.set(g,c);c=a!=null&&!d("MAWFTSRestoreCap").isRestoreTimeWithinCap(parseInt(a,10));d("MAWFTSRestoreSyncLogger").incrementTotalResultCount(c)}if(a==="0")return;b.$2.add(d("WAJids").unsafeCoerceToChatJid(g));return d("MAWBridgeSendAndReceive").sendAndReceive("backend","searchSetFTSNextTimestamp",{newSortOrderMs:h.to_string(e),threadId:g})}).finally(function(){b.$7.delete(g),b.$7.size===0&&!b.$6&&d("MAWFTSRestoreSyncLogger").onFetchThreadsComplete()}))};b.$9=async function(){var a=this,b=await this.$12();b=d("ReQL").fromTableAscending(b.tables.messenger_fts_threads,["threadId","nextMessageTimestamp","threadType"]);b.subscribe(function(b,c){c.operation==="add"&&a.$13(c.value)});b=await d("ReQL").toArrayAsync(b);b.forEach(function(b){a.$13(b)})};b.$12=async function(){this.$3==null&&(this.$3=await (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return this.$3};return a}();function a(){j==null&&(j=new k());return j}g.MAWFTSThreadsRestore=k;g.getInstance=a}),98);
__d("MAWFetchAndPersistMedia",["CurrentUser","EBAPI","EBBridgedAPI","EchoMessage","EchoMessageMediaFieldUtils","I64","LSDatabaseSingleton","LSIntEnum","LSMEBTaskCreationSource","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWJobDefinitions","MAWMediaRestoreEBRange","MAWMsgType","MAWRestoreMessagesFromEncryptedBackupsDeferred","MAWRestoreProtobufsFromEncryptedBackupsDeferred","ReQL","WAJids","WALogger","WAResultOrError","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Protobuf error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Echo error: ",""]);l=function(){return a};return a}b=c("justknobx")._("3177");var m=c("justknobx")._("2538"),n=c("justknobx")._("3916"),o="timeout",p=b;function a(a,b,c,e){var f=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange(),g=f.getRange(b),i=d("WAJids").threadIdForChatJid(a);if(g.hasMoreBefore===!1)return Promise.resolve();e==null?void 0:e.addPoint("eb_fetch_and_persist_start",{int:{mediaGalleryGroup:c}});return u({jid:a,nextTimestampMsBefore:g.nextTimestampMsBefore,numMessages:p,threadId:i}).then(function(a){var g=a.error;g!=null&&(e==null?void 0:e.addPoint("eb_fetch_and_persist_error",{string:{error:g}}));if(g!==o){f.updateRange(b,{hasMoreBefore:(g=a==null?void 0:a.hasMoreBefore)!=null?g:!1,nextTimestampMsBefore:(h||(h=d("I64"))).to_string((g=a==null?void 0:a.nextMessageTimestampMsBefore)!=null?g:(h||(h=d("I64"))).zero)})}return q(a,i).then(function(){e==null?void 0:e.addPoint("eb_fetch_and_persist_end");return t(b,c,{hasMoreBefore:!0})})})}function q(a,b){if(a.success===!1)return Promise.resolve();if(a.echoMessages!=null&&a.echoMessages.length>0)return r(a,b);return a.protobufMessages!=null&&a.protobufMessages.length>0?s(a,b):Promise.resolve()}function r(a,b){var e;e=(e=a==null?void 0:a.echoMessages)!=null?e:[];var f=[d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO],g=e.filter(function(a){a=d("EchoMessage").decodeEchoMessage(a);return(a==null?void 0:a.contentType)===d("EchoMessage").EchoMessageContentType.MEDIA&&f.includes(a==null?void 0:(a=a.mediaData)==null?void 0:a.attachmentType)});e.length!==g.length&&(p=m);return d("MAWRestoreMessagesFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),g,(e=a==null?void 0:a.hasMoreBefore)!=null?e:!1,void 0,(b=a==null?void 0:a.hasMoreAfter)!=null?b:!1,void 0,(g=a==null?void 0:a.isPointQuery)!=null?g:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE).catch(function(a){d("WALogger").ERROR(l(),a)})}function s(a,b){var e,f=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());e=(e=a==null?void 0:a.protobufMessages)!=null?e:[];var g=[d("MAWMsgType").MSG_TYPE.IMAGE,d("MAWMsgType").MSG_TYPE.VIDEO],i=e.filter(function(a){a=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(a,f,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);return g.includes(a.msgType)});e.length!==i.length&&(p=m);return d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),i,(e=a==null?void 0:a.hasMoreBefore)!=null?e:!1,void 0,(b=a==null?void 0:a.hasMoreAfter)!=null?b:!1,void 0,(i=a==null?void 0:a.isPointQuery)!=null?i:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,void 0,void 0,(h||(h=d("I64"))).of_int32(c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE)).catch(function(a){d("WALogger").ERROR(k(),a)})}async function t(a,b,c){var e=await (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton;return e.runInTransaction(async function(f){var g=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(h||(h=d("I64"))).equal(a.mediaGroup,(j||(j=d("LSIntEnum"))).ofNumber(b))}));if(g==null)return;var i=babelHelpers.extends({},g,{},c);return f.attachments_ranges_v2__generated.upsert([g.threadKey,g.mediaGroup,g.minTimestampMs],i)},"readwrite","ui",void 0,f.id+":226")}async function u(a){var b,e=a.jid,f=a.nextTimestampMsBefore,g=a.numMessages;a=a.threadId;f=c("gkx")("5431")?c("EBBridgedAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE}):c("EBAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE});var i=null;f=await Promise.race([f,new Promise(function(a){i=window.setTimeout(function(){return a(d("WAResultOrError").makeError(o))},n)})]);window.clearTimeout(i);if(f.success===!1)return f;f=f.value;b=(h||(h=d("I64"))).to_string((b=f==null?void 0:f.nextMessageTimestampMsBefore)!=null?b:(h||(h=d("I64"))).zero);return(f==null?void 0:f.referenceTimestamp)===b?g===m?d("WAResultOrError").makeError("Retried with max pageSize: "+m+". Still stuck"):u({jid:e,nextTimestampMsBefore:b,numMessages:m,threadId:a}):f}g.MAWFetchAndPersistMedia=a;g.updateLocalAttachmentsRange=t}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4),e,f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),f=i.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"}),b[0]=e,b[1]=f):(e=b[0],f=b[1]);b[2]!==a?(e=i.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[e,f]})),b[2]=a,b[3]=e):e=b[3];return e}g["default"]=a}),98);
__d("useMAWBulkMaybeAutoTriggerDownload",["MAWDownloadMediaInWorkerDeferred","MAWMediaDownloadStatus","MAWStateContext.react","gkx","justknobx","react","react-compiler-runtime","useAsyncReStore","useMAWBulkMediaDownloadStatus"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useEffect;b.useMemo;var k=b.useRef;function a(a,b,e){var f=d("react-compiler-runtime").c(11),g=c("useMAWBulkMediaDownloadStatus")(a),h;f[0]!==g?(h=new Map(g.map(l)),f[0]=g,f[1]=h):h=f[1];g=h;var m=g;f[2]===Symbol["for"]("react.memo_cache_sentinel")?(h=new Map(),f[2]=h):h=f[2];var n=k(h),o=c("useAsyncReStore")(),p=i(d("MAWStateContext.react").MAWDispatchContext);f[3]!==a||f[4]!==o||f[5]!==p||f[6]!==e||f[7]!==m||f[8]!==b?(g=function(){var f=[];a.forEach(function(a){var g,h,i=a.attachment;a=a.mediaRenderQpl;g=(g=m.get(i.attachmentFbid))!=null?g:!1;h=(h=n.current.get(i.attachmentFbid))!=null?h:!1;g&&!h&&(n.current.set(i.attachmentFbid,!0),!c("justknobx")._("3226")?d("MAWDownloadMediaInWorkerDeferred").maybeDownloadMediaInWorker({attachment:i,dbPromise:o,dispatch:p,downloadType:e,mediaRenderQpl:a,triggerUIView:b}):f.push({attachment:i,mediaRenderQpl:a}))});f.length>0&&d("MAWDownloadMediaInWorkerDeferred").maybeBulkDownloadMediaInWorker({attachmentsWithQpl:f,dbPromise:o,dispatch:p,downloadType:e,triggerUIView:b})},h=[a,o,p,e,n,m,b],f[3]=a,f[4]=o,f[5]=p,f[6]=e,f[7]=m,f[8]=b,f[9]=g,f[10]=h):(g=f[9],h=f[10]);j(g,h)}function l(a){var b;b=(a==null?void 0:(b=a.status)==null?void 0:b.mainMediaStatus)===c("MAWMediaDownloadStatus").MISSING_FILE||(a==null?void 0:(b=a.status)==null?void 0:b.mainMediaStatus)===c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE||c("gkx")("5850")&&(a==null?void 0:(b=a.status)==null?void 0:b.mainMediaStatus)===c("MAWMediaDownloadStatus").DOWNLOADING;return[a.attachment.attachmentFbid,b]}g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWClientMediaStatusUtils","MAWMediaManagerUiIntegrationCheck","MAWVideoAudioPlaybackErrorHandlerUtils","MessagingAttachmentType","RavenMessagingState","ReQL","ReQLSuspense","cr:17327","cr:17328","filterNulls","react","react-compiler-runtime","useEmptyFunction","useMAWBulkMaybeAutoTriggerDownload","usePrevious","useReStore","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||(i=d("react"));e=i;var m=e.createContext;e.useCallback;var n=e.useEffect,o=e.useMemo,p=e.useState,q=(e=b("cr:17327"))!=null?e:c("useEmptyFunction"),r=(e=b("cr:17328"))!=null?e:c("useEmptyFunction"),s=b("$InternalEnum")({Image:0,Video:1}),t=m({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,shouldTriggerLoadMore:!1});function u(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function v(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function w(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function x(a,b,e,f){var g=f.attachmentType;return!w(a,b,e,f)?!1:u(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function y(a,b,e,f,g,h){var i=f.attachmentFbid,l=f.attachmentType,m=!1,n=!1;if(d("MAWVideoAudioPlaybackErrorHandlerUtils").isVideoFallbackExperiencesEnabled({silent:!1})){h=d("MAWClientMediaStatusUtils").getStatusDataFromLsdbOrContext({clientMediaStatus:h,mediaDownloadStatusState:g,statusKey:i});g=h.hasStatus;i=h.statusData;if(g){h=i!=null?i:{};g=h.validationResult;m=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(f,g):!1;n=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(f,g):!1}}return!w(a,b,e,f)||m||n?!1:v(f)||(j||(j=d("I64"))).equal(l,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function z(a,b){n(function(){a.forEach(function(a){try{a.attachment.hasMedia&&b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function A(a){var b=a.attachments,e=a.children,f=a.getIsSecureThread,g=a.getPlayableUrl,h=a.getPreviewUrl;a=a.initialAttachment;a=p(a);var i=a[0],j=a[1];a=c("usePrevious")(i==null?void 0:i.messageId);var k=q(),m=o(function(){return b.map(function(a){return{attachment:a,mediaRenderQpl:null,statusKey:a.attachmentFbid}})},[b]),n=r(m),u=o(function(){return i!=null&&d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()?{attachment:i,mediaRenderQpl:null,statusKey:i.attachmentFbid}:null},[i]);c("useMAWBulkMaybeAutoTriggerDownload")(m,"fullsize","preview");c("useMAWBulkMaybeAutoTriggerDownload")(u!=null?[u]:[],"fullsize","fullsizeAndPreview");var v=o(function(){return c("filterNulls")(b.map(function(a){var b=f(a);if(x(g,h,b,a))return{attachment:a,type:s.Image};return y(g,h,b,a,k,n)?{attachment:a,type:s.Video}:null}))},[b,n,f,g,h,k]),w=i==null?-1:v.findIndex(function(a){return a.attachment.attachmentFbid===i.attachmentFbid&&a.attachment.messageId===i.messageId}),A=a!=null&&(i==null?void 0:i.messageId)!==a&&w>v.length-5;z(v,h);m=o(function(){var a=Math.max(0,v.length-1);return{canMoveBackward:w>0&&w!==-1,canMoveForward:w<a&&w!==-1,card:v[w],cards:v,currentIndex:w,moveBackward:function(){var a=Math.max(w-1,0);j((a=v[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(w+1,a);j((b=v[b])==null?void 0:b.attachment)},moveTo:function(a){j(a.attachment)},numberOfCards:v.length,shouldTriggerLoadMore:A}},[v,w,A]);return l.jsx(t.Provider,{value:m,children:e})}A.displayName=A.name+" [from "+f.id+"]";function a(a){var b=d("react-compiler-runtime").c(28),e=a.attachmentFbid,g=a.children,i=a.getPlayableUrl,j=a.getPreviewUrl,k=a.isSecureThread,m=a.threadKey;c("vulture")("SQUu5DBRrDsh1pluf1mTgMML8vU=");var n=q(),o=(h||(h=c("useReStore")))();b[0]!==e||b[1]!==o.tables.attachments||b[2]!==m?(a=function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return a.attachmentFbid===e})},b[0]=e,b[1]=o.tables.attachments,b[2]=m,b[3]=a):a=b[3];var p;b[4]!==e||b[5]!==o||b[6]!==m?(p=[o,m,e],b[4]=e,b[5]=o,b[6]=m,b[7]=p):p=b[7];a=d("ReQLSuspense").useFirst(a,p,f.id+":378");var r;b[8]!==o.tables.attachments||b[9]!==o.tables.client_media_status||b[10]!==i||b[11]!==j||b[12]!==k||b[13]!==n||b[14]!==m?(p=function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){var b=n==null?d("ReQLSuspense").toArray(d("ReQL").fromTableAscending(o.tables.client_media_status).getKeyRange(a.attachmentFbid),f.id+":393"):void 0;return x(i,j,k,a)||y(i,j,k,a,n,b)})},r=[o.tables.attachments,o.tables.client_media_status,m,n,i,j,k],b[8]=o.tables.attachments,b[9]=o.tables.client_media_status,b[10]=i,b[11]=j,b[12]=k,b[13]=n,b[14]=m,b[15]=p,b[16]=r):(p=b[15],r=b[16]);p=d("ReQLSuspense").useArray(p,r,f.id+":386");b[17]!==p?(r=[].concat(p).sort(B),b[17]=p,b[18]=r):r=b[18];p=r;r=p;b[19]!==k?(p=function(){return k},b[19]=k,b[20]=p):p=b[20];p=p;var s;b[21]!==a||b[22]!==g||b[23]!==p||b[24]!==i||b[25]!==j||b[26]!==r?(s=l.jsx(A,{attachments:r,getIsSecureThread:p,getPlayableUrl:i,getPreviewUrl:j,initialAttachment:a,children:g}),b[21]=a,b[22]=g,b[23]=p,b[24]=i,b[25]=j,b[26]=r,b[27]=s):s=b[27];return s}function B(a,b){return(j||(j=d("I64"))).compare(b.timestampMs,a.timestampMs)}g.AttachmentMediaType=s;g.context=t;g.MWChatAttachmentMediaStateProviderFromAttachments=A;g.MWChatAttachmentMediaStateProvider=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","justknobx","react","react-compiler-runtime","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext;b.useMemo;var l={key:c("CometKeys").LEFT},m={key:c("CometKeys").RIGHT},n={key:c("CometKeys").ESCAPE},o=h._(/*BTDS*/"Next item"),p=h._(/*BTDS*/"Previous item"),q=h._(/*BTDS*/"Close");function a(a){var b=d("react-compiler-runtime").c(12),e=a.children;a=a.onClose;var f=k(d("MWChatAttachmentMediaState.react").context),g=f.moveBackward;f=f.moveForward;var h;b[0]!==g?(h={command:l,description:o,handler:g},b[0]=g,b[1]=h):h=b[1];b[2]!==f?(g={command:m,description:p,handler:f},b[2]=f,b[3]=g):g=b[3];b[4]!==a?(f=a!=null?{command:n,description:q,handler:a}:null,b[4]=a,b[5]=f):f=b[5];b[6]!==h||b[7]!==g||b[8]!==f?(a=[h,g,f].filter(Boolean),b[6]=h,b[7]=g,b[8]=f,b[9]=a):a=b[9];h=a;g=h;c("useLayerKeyCommands")(g);b[10]!==e?(f=c("justknobx")._("3491")?j.jsx(j.Fragment,{children:e!=null?e:null}):j.jsx("div",{children:e!=null?e:null}),b[10]=e,b[11]=f):f=b[11];return f}g.keyLeft=l;g.keyRight=m;g.keyEscape=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","react","react-compiler-runtime","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a){var b=a.card,c=a.getPlayableUrl;a=a.getPreviewUrl;var e=b.attachment,f,g="/images/comet/gray.png";if(e.hasMedia===!1)f=g;else{f=(a=a(e,"toFilmstripThumbnail"))!=null?a:g}a=f;b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&!Boolean(f)&&(a=c(e,"toFilmstripThumbnail"));if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(g=e.accessibilitySummaryText)!=null?g:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:f,width:0}}return{height:0,mediaType:"video",thumbnailUri:f,uri:a,width:0}}function m(a){var b,e=d("react-compiler-runtime").c(23),f=a.activeCard,g=a.cards,h=a.getPreviewUrl,k=a.onSetImage;c("vulture")("a8AZq8A-1kxuvaKzeYCTuDl5B5k=");var m=j(d("MWV2MediaViewerContext.react").context);e[0]!==m?(a=function(a,b){return a==null?"":(a=m.getDownloadUrl(a,b))!=null?a:""},e[0]=m,e[1]=a):a=e[1];var n=a;if(e[2]!==g||e[3]!==n||e[4]!==h){e[6]!==n||e[7]!==h?(a=function(a){return l({card:a,getPlayableUrl:n,getPreviewUrl:h})},e[6]=n,e[7]=h,e[8]=a):a=e[8];a=g.map(a);e[2]=g;e[3]=n;e[4]=h;e[5]=a}else a=e[5];a=a;if(e[9]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid)||e[10]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.messageId)||e[11]!==g){if(e[13]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid)||e[14]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.messageId)){var o;b=function(a){var b;return a.attachment.attachmentFbid===(f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid)&&a.attachment.messageId===(f==null?void 0:(b=f.attachment)==null?void 0:b.messageId)};e[13]=f==null?void 0:(o=f.attachment)==null?void 0:o.attachmentFbid;e[14]=f==null?void 0:(o=f.attachment)==null?void 0:o.messageId;e[15]=b}else b=e[15];o=g.findIndex(b);e[9]=f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid;e[10]=f==null?void 0:(b=f.attachment)==null?void 0:b.messageId;e[11]=g;e[12]=o}else o=e[12];b=o;e[16]!==g||e[17]!==k?(o=function(a){return k(g[a])},e[16]=g,e[17]=k,e[18]=o):o=e[18];var p;e[19]!==b||e[20]!==a||e[21]!==o?(p=i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:b,images:a,onSetImage:o}),e[19]=b,e[20]=a,e[21]=o,e[22]=p):p=e[22];return p}function a(a){var b=d("react-compiler-runtime").c(6);a=a.getPreviewUrl;var e=j(d("MWChatAttachmentMediaState.react").context),f=e.card,g=e.cards;e=e.moveTo;g=k(g);var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h={className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62"},b[0]=h):h=b[0];b[1]!==f||b[2]!==g||b[3]!==a||b[4]!==e?(h=i.jsx("div",babelHelpers["extends"]({},h,{children:i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:i.jsx(m,{activeCard:f,cards:g,getPreviewUrl:a,onSetImage:e})})})),b[1]=f,b[2]=g,b[3]=a,b[4]=e,b[5]=h):h=b[5];return h}g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","FDSCircleButton.react","MDSShareSvgIcon.react","ODS","SVGIcon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e=a.color,f=a.onOpenForwardDialog;a=a.type;var g;b[0]!==e?(g=d("SVGIcon").legacySVGIcon(function(){return k.jsx(c("MDSShareSvgIcon.react"),{color:e,size:24})}),b[0]=e,b[1]=g):g=b[1];var i;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"Forward"),b[2]=i):i=b[2];var l;b[3]!==f?(l=function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),f()},b[3]=f,b[4]=l):l=b[4];bb0:{switch(a){case"deemphasized":a="deemphasized";break bb0;case"normal":a="normal";break bb0;case"overlay":a="overlay";break bb0;case"dark_overlay":a="dark-overlay";break bb0;case"deemphasized_overlay":case"overlay_raised":a="overlay-raised";break bb0;case"primary_background_overlay":a="primary-background-overlay";break bb0}a=void 0}b[5]!==g||b[6]!==l||b[7]!==a?(i=k.jsx(c("FDSCircleButton.react"),{icon:g,label:i,onPress:l,size:36,testid:void 0,type_DEPRECATED:a}),b[5]=g,b[6]=l,b[7]=a,b[8]=i):i=b[8];return i}g["default"]=a}),226);
__d("MWChatMediaViewerControls.react",["fbt","FDSCircleButton.react","FDSPhotoDownloadFilled20Icon","FDSShareFilled20Icon","FDSTooltip.react","Int64Hooks","LSFactory","LSIntEnum","LSMessagePointQueryStoredProcedure","LSVerifyThreadRowExistsStoredProcedure","MWChatMessageId","MWXRow.react","MWXRowItem.react","ODS","ReQL","ReQLSuspense","emptyFunction","promiseDone","react","react-compiler-runtime","useMWChatForward","useMWV2ForwardMessage","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||(l=d("react"));l.useCallback;var n=h._(/*BTDS*/"Download"),o=h._(/*BTDS*/"Forward");function p(a,b){var e=d("react-compiler-runtime").c(18),g=(i||(i=c("useReStore")))(),h,k;e[0]!==g||e[1]!==b?(h=function(){return b!=null?d("ReQL").fromTableAscending(g.tables.threads,["threadType"]).getKeyRange(b).map(q):d("ReQL").empty()},k=[g,b],e[0]=g,e[1]=b,e[2]=h,e[3]=k):(h=e[2],k=e[3]);var l=d("ReQLSuspense").useFirst(h,k,f.id+":62");e[4]!==g||e[5]!==a?(h=function(){return a!=null?d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a):d("ReQL").empty()},k=[g,a],e[4]=g,e[5]=a,e[6]=h,e[7]=k):(h=e[6],k=e[7]);var m=d("ReQLSuspense").useFirst(h,k,f.id+":74");e[8]!==g||e[9]!==m||e[10]!==a||e[11]!==l||e[12]!==b?(h=function(){if(a==null||b==null)return;if(l==null){c("promiseDone")(g.runInTransaction(function(a){return c("LSVerifyThreadRowExistsStoredProcedure")(c("LSFactory")(a),{syncGroup:(j||(j=d("LSIntEnum"))).ofNumber(1),threadKey:b})},"readwrite",void 0,void 0,f.id+":90"));return}m==null&&c("promiseDone")(g.runInTransaction(function(d){return c("LSMessagePointQueryStoredProcedure")(c("LSFactory")(d),{messageId:a,threadKey:b,threadType:l})},"readwrite",void 0,void 0,f.id+":103"))},k=[g,m,a,l,b],e[8]=g,e[9]=m,e[10]=a,e[11]=l,e[12]=b,e[13]=h,e[14]=k):(h=e[13],k=e[14]);d("Int64Hooks").useEffectInt64(h,k);e[15]!==m||e[16]!==l?(h=[m,l],e[15]=m,e[16]=l,e[17]=h):h=e[17];return h}function q(a){a=a.threadType;return a}function a(a){var b=d("react-compiler-runtime").c(11),e=a.attachmentID,f=a.canForward,g=a.downloadLink,h=a.isCrossTransportForwardEnabled,i=a.isSecureForwardEnabled;a=a.messageID;f=f===void 0?!0:f;h=h===void 0?!1:h;i=i===void 0?!1:i;var j;b[0]!==g?(j=g!=null?m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("FDSTooltip.react"),{align:"middle",tooltip:n,children:m.jsx(c("FDSCircleButton.react"),{icon:c("FDSPhotoDownloadFilled20Icon"),label:n,linkProps:{download:!0,target:"_blank",url:g},size:36,type_DEPRECATED:"dark-overlay"})})}):null,b[0]=g,b[1]=j):j=b[1];b[2]!==e||b[3]!==f||b[4]!==h||b[5]!==i||b[6]!==a?(g=f===!0?m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("FDSTooltip.react"),{align:"middle",tooltip:o,children:m.jsx(s,{attachmentID:e,isCrossTransportForwardEnabled:h,isSecureForwardEnabled:i,messageID:a})})}):null,b[2]=e,b[3]=f,b[4]=h,b[5]=i,b[6]=a,b[7]=g):g=b[7];b[8]!==j||b[9]!==g?(e=m.jsxs(c("MWXRow.react"),{paddingTop:0,spacing:8,children:[j,g]}),b[8]=j,b[9]=g,b[10]=e):e=b[10];return e}function r(a){var b=d("react-compiler-runtime").c(8),e=a.isCrossTransportForwardEnabled,f=a.isSecureForwardEnabled,g=a.messageID;a=a.onForwardSend;e=e===void 0?!1:e;f=f===void 0?!1:f;f=f?"secure":e?"cross_transport":"open_";b[0]!==f||b[1]!==g||b[2]!==a?(e={forwardDialogType:f,messageID:g,onClose:c("emptyFunction"),onSend:a},b[0]=f,b[1]=g,b[2]=a,b[3]=e):e=b[3];var h=c("useMWChatForward")(e);b[4]!==h?(f=function(){(k||(k=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),h&&h.onClick()},b[4]=h,b[5]=f):f=b[5];var i=f;b[6]!==i?(g=m.jsx(c("FDSCircleButton.react"),{icon:c("FDSShareFilled20Icon"),label:o,onPress:function(a){return i()},size:36,testid:void 0,type_DEPRECATED:"dark-overlay"}),b[6]=i,b[7]=g):g=b[7];return g}function s(a){var b=d("react-compiler-runtime").c(11),c=a.attachmentID,e=a.isCrossTransportForwardEnabled,f=a.isSecureForwardEnabled;a=a.messageID;e=e===void 0?!1:e;f=f===void 0?!1:f;var g;b[0]!==a?(g=d("MWChatMessageId").getMessageId(a),b[0]=a,b[1]=g):g=b[1];g=g;var h;b[2]!==a?(h=d("MWChatMessageId").getThreadId(a),b[2]=a,b[3]=h):h=b[3];h=h;g=p(g,h);h=g[0];g=g[1];if(h==null||g==null)return null;var i;b[4]!==c||b[5]!==e||b[6]!==f||b[7]!==h||b[8]!==a||b[9]!==g?(i=m.jsx(t,{attachmentID:c,isCrossTransportForwardEnabled:e,isSecureForwardEnabled:f,message:h,messageID:a,messageThreadType:g}),b[4]=c,b[5]=e,b[6]=f,b[7]=h,b[8]=a,b[9]=g,b[10]=i):i=b[10];return i}function t(a){var b=d("react-compiler-runtime").c(7),e=a.attachmentID,f=a.isCrossTransportForwardEnabled,g=a.isSecureForwardEnabled,h=a.message,i=a.messageID;a=a.messageThreadType;f=f===void 0?!1:f;g=g===void 0?!1:g;var j=d("useMWV2ForwardMessage").useMWV2ForwardMessage(h,a,e);b[0]!==j?(h=function(a){return c("promiseDone")(j(a))},b[0]=j,b[1]=h):h=b[1];a=h;b[2]!==f||b[3]!==g||b[4]!==i||b[5]!==a?(e=m.jsx(r,{isCrossTransportForwardEnabled:f,isSecureForwardEnabled:g,messageID:i,onForwardSend:a}),b[2]=f,b[3]=g,b[4]=i,b[5]=a,b[6]=e):e=b[6];return e}g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWMessageSearchStatusTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["IN_PROGRESS","COMPLETE","NOT_RUNNING","NOT_REQUIRED"]);c=b("$InternalEnum").Mirrored(["IN_PROGRESS","COMPLETE","NOT_STARTED"]);d=b("$InternalEnum").Mirrored(["NOT_STARTED","IN_PROGRESS","COMPLETE","FAILED"]);f.RestoreStatus=a;f.OverallStatus=c;f.PrimarySearchStatus=d}),66);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");l.useCallback;var m=l.useEffect,n=l.useState;function a(a){var b=d("react-compiler-runtime").c(33),e=a.attachmentsRange,f=a.hasMore,g=a.loadMore,h=a.logLoadMediaCancel,i=a.logLoadMediaSuccess,j=a.media,k=a.skipInitialLoad;a=n(!1);var l=a[0],o=a[1],p=j.length,q=(a=c("usePrevious")(p))!=null?a:0,r=c("usePrevious")(f),s=(j=c("usePrevious")(l))!=null?j:!1,t=e!=null;b[0]!==t||b[1]!==g||b[2]!==k?(a=function(){!t&&k!==!0&&(g(),o(!0))},j=[t,g,k],b[0]=t,b[1]=g,b[2]=k,b[3]=a,b[4]=j):(a=b[3],j=b[4]);m(a,j);b[5]!==e||b[6]!==f||b[7]!==l||b[8]!==g||b[9]!==i||b[10]!==p||b[11]!==r||b[12]!==s||b[13]!==q?(a=function(){var a=q!==p,b=r===!0&&!f||e==null&&f===!1&&r===!1&&q===p;l&&(b||a)?(o(!1),i==null?void 0:i({fetchedMediaCount:p-q,startMediaCount:q})):q===p&&f&&l&&s===!0&&(i==null?void 0:i({fetchedMediaCount:p-q,isAlreadyPreloaded:!0,startMediaCount:q}),g())},b[5]=e,b[6]=f,b[7]=l,b[8]=g,b[9]=i,b[10]=p,b[11]=r,b[12]=s,b[13]=q,b[14]=a):a=b[14];b[15]!==e||b[16]!==f||b[17]!==l||b[18]!==g||b[19]!==h||b[20]!==i||b[21]!==p||b[22]!==r||b[23]!==s||b[24]!==q?(j=[p,f,l,q,r,e,g,s,i,h],b[15]=e,b[16]=f,b[17]=l,b[18]=g,b[19]=h,b[20]=i,b[21]=p,b[22]=r,b[23]=s,b[24]=q,b[25]=j):j=b[25];m(a,j);b[26]!==l||b[27]!==g?(h=function(){if(!l){g();return o(!0)}},b[26]=l,b[27]=g,b[28]=h):h=b[28];a=h;j=p>0||!l&&!f;b[29]!==j||b[30]!==l||b[31]!==a?(h=[l,a,j],b[29]=j,b[30]=l,b[31]=a,b[32]=h):h=b[32];return h}function o(a,b,e,g){var i=d("react-compiler-runtime").c(19),j;i[0]!==g?(j=g===void 0?{}:g,i[0]=g,i[1]=j):j=i[1];g=j;j=g.removeUnsentMessages;var k=j===void 0?!1:j,l=(h||(h=c("useReStore")))();g=t(a,b);j=g.attachmentsRange;b=g.hasMoreBefore;var m=g.minTimestampMs,n=g.query;i[2]!==l||i[3]!==e||i[4]!==k?(g=function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":146");return b==null||b.isUnsent?null:a},i[2]=l,i[3]=e,i[4]=k,i[5]=g):g=i[5];var o=g;i[6]!==o||i[7]!==n?(g=function(){return n.map(o).filter(Boolean)},i[6]=o,i[7]=n,i[8]=g):g=i[8];var p;i[9]!==l||i[10]!==m||i[11]!==o||i[12]!==a?(p=[l,a,o,m],i[9]=l,i[10]=m,i[11]=o,i[12]=a,i[13]=p):p=i[13];a=d("ReQLSuspense").useArray(g,p,f.id+":159");i[14]!==a||i[15]!==j||i[16]!==b||i[17]!==m?(g=[a,j,m,b],i[14]=a,i[15]=j,i[16]=b,i[17]=m,i[18]=g):g=i[18];return g}function p(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url"||a==="xma_open_native":!1}function b(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[0]=f):f=e[0];a=o(a,f,p,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function q(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[0]=f):f=e[0];a=o(a,f,q,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function s(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[0]=f):f=e[0];a=o(a,f,r,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function t(a,b){var e=d("react-compiler-runtime").c(17),g=(h||(h=c("useReStore")))(),j;e[0]!==g.tables.attachments_ranges_v2__generated||e[1]!==b||e[2]!==a?(j=function(){return d("ReQL").fromTableDescending(g.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},e[0]=g.tables.attachments_ranges_v2__generated,e[1]=b,e[2]=a,e[3]=j):j=e[3];var k;e[4]!==g||e[5]!==b||e[6]!==a?(k=[g,a,b],e[4]=g,e[5]=b,e[6]=a,e[7]=k):k=e[7];j=d("ReQLSuspense").useFirst(j,k,f.id+":284");k=j==null?void 0:j.minTimestampMs;var l=j==null?void 0:j.hasMoreBefore;if(e[8]!==g.tables.attachments||e[9]!==k||e[10]!==a){var m=d("ReQL").fromTableDescending(g.tables.attachments.index("fk_messages")).getKeyRange(a);m=k!=null&&(i||(i=d("I64"))).to_float(k)!==Number.MAX_SAFE_INTEGER?m.bounds({gte:d("ReQL").key(k)}):m;e[8]=g.tables.attachments;e[9]=k;e[10]=a;e[11]=m}else m=e[11];m=m;var n;e[12]!==j||e[13]!==l||e[14]!==k||e[15]!==m?(n={attachmentsRange:j,hasMoreBefore:l,minTimestampMs:k,query:m},e[12]=j,e[13]=l,e[14]=k,e[15]=m,e[16]=n):n=e[16];return n}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=q;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=s;g.useAttachmentsQuery=t}),98);
__d("MWV2MediaViewerControls.react",["fbt","FDSCircleButton.react","FDSCrossFilled16Icon","FDSPhotoDownloadFilled16Icon","Int64Hooks","LSMessagingThreadTypeUtil","MDSRow.react","MDSRowItem.react","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXTooltip.react","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=h._(/*BTDS*/"Download");function a(a){var b=d("react-compiler-runtime").c(15),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var i=k(d("MWV2MediaViewerContext.react").context),n;b[0]!==e||b[1]!==i?(n=i.getDownloadUrl(e,"MWV2MediaViewerControls"),b[0]=e,b[1]=i,b[2]=n):n=b[2];i=n;b[3]!==i?(n=i!=null?j.jsx(c("MDSRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:l,children:j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:c("FDSPhotoDownloadFilled16Icon"),label:l,linkProps:{download:!0,target:"_blank",url:i},size:36,type_DEPRECATED:"dark-overlay"})})}):null,b[3]=i,b[4]=n):n=b[4];b[5]!==e||b[6]!==f||b[7]!==a?(i=f!=null?j.jsx(m,{attachment:e,message:f,thread:a}):null,b[5]=e,b[6]=f,b[7]=a,b[8]=i):i=b[8];b[9]!==g?(e=g!=null?j.jsx(c("MDSRowItem.react"),{children:j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:c("FDSCrossFilled16Icon"),label:h._(/*BTDS*/"Close"),onPress:g,size:36,type_DEPRECATED:"dark-overlay"})}):null,b[9]=g,b[10]=e):e=b[10];b[11]!==n||b[12]!==i||b[13]!==e?(f=j.jsxs(c("MDSRow.react"),{paddingTop:0,spacing:8,children:[n,i,e]}),b[11]=n,b[12]=i,b[13]=e,b[14]=f):f=b[14];return f}function m(a){var b=d("react-compiler-runtime").c(9),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var k,l;b[2]!==g.threadType?(k=function(){return g.threadType},l=[g.threadType],b[2]=g.threadType,b[3]=k,b[4]=l):(k=b[3],l=b[4]);k=d("Int64Hooks").useMemoInt64(k,l);l=c("useMWV2MessageForwardAction")(i,f,k);i=c("useMWHasForwardAction")(g.threadType,f,e);k=i.shouldShowForwardAction;if(a==null||!k)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._(/*BTDS*/"Forward"),b[5]=f):f=b[5];b[6]!==a||b[7]!==l?(e=j.jsx(c("MDSRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:f,children:j.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:l,type:"dark_overlay"})})}),b[6]=a,b[7]=l,b[8]=e):e=b[8];return e}g["default"]=a}),226);
__d("MWV2MediaViewerControlsV2.react",["fbt","CometPlaceholder.react","FDSCircleButton.react","FDSCrossFilled16Icon","FDSPhotoDownloadFilled16Icon","Int64Hooks","LSMessagingThreadTypeUtil","MDSRow.react","MDSRowItem.react","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXTooltip.react","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=h._(/*BTDS*/"Download"),m=h._(/*BTDS*/"Download not ready");function n(a){var b=d("react-compiler-runtime").c(5);a=a.attachment;var e=k(d("MWV2MediaViewerContext.react").context),f;b[0]!==a||b[1]!==e?(f=e.getDownloadUrl(a,"MWV2MediaViewerControls"),b[0]=a,b[1]=e,b[2]=f):f=b[2];a=f;if(a==null)return null;b[3]!==a?(e=j.jsx(c("MWXTooltip.react"),{tooltip:l,children:j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:c("FDSPhotoDownloadFilled16Icon"),label:l,linkProps:{download:!0,target:"_blank",url:a},size:36,type_DEPRECATED:"dark-overlay"})}),b[3]=a,b[4]=e):e=b[4];return e}function o(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("MWXTooltip.react"),{tooltip:l,children:j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",disabled:!0,icon:c("FDSPhotoDownloadFilled16Icon"),label:m,size:36,type_DEPRECATED:"dark-overlay"})}),a[0]=b):b=a[0];return b}function a(a){var b=d("react-compiler-runtime").c(13),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var i;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(i=j.jsx(o,{}),b[0]=i):i=b[0];b[1]!==e?(i=j.jsx(c("MDSRowItem.react"),{children:j.jsx(c("CometPlaceholder.react"),{fallback:i,children:j.jsx(n,{attachment:e})})}),b[1]=e,b[2]=i):i=b[2];var k;b[3]!==e||b[4]!==f||b[5]!==a?(k=f!=null?j.jsx(p,{attachment:e,message:f,thread:a}):null,b[3]=e,b[4]=f,b[5]=a,b[6]=k):k=b[6];b[7]!==g?(e=g!=null?j.jsx(c("MDSRowItem.react"),{children:j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:c("FDSCrossFilled16Icon"),label:h._(/*BTDS*/"Close"),onPress:g,size:36,type_DEPRECATED:"dark-overlay"})}):null,b[7]=g,b[8]=e):e=b[8];b[9]!==i||b[10]!==k||b[11]!==e?(f=j.jsxs(c("MDSRow.react"),{paddingTop:0,spacing:8,children:[i,k,e]}),b[9]=i,b[10]=k,b[11]=e,b[12]=f):f=b[12];return f}function p(a){var b=d("react-compiler-runtime").c(9),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var k,l;b[2]!==g.threadType?(k=function(){return g.threadType},l=[g.threadType],b[2]=g.threadType,b[3]=k,b[4]=l):(k=b[3],l=b[4]);k=d("Int64Hooks").useMemoInt64(k,l);l=c("useMWV2MessageForwardAction")(i,f,k);i=c("useMWHasForwardAction")(g.threadType,f,e);k=i.shouldShowForwardAction;if(a==null||!k)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._(/*BTDS*/"Forward"),b[5]=f):f=b[5];b[6]!==a||b[7]!==l?(e=j.jsx(c("MDSRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:f,children:j.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:l,type:"dark_overlay"})})}),b[6]=a,b[7]=l,b[8]=e):e=b[8];return e}g["default"]=a}),226);
__d("MWV2MediaViewerControlsContainer.react",["CometPlaceholder.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","MWV2MediaViewerControlsV2.react","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(5),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var h;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==a?(h=c("gkx")("11885")?i.jsx(c("MWV2MediaViewerControlsV2.react"),{attachment:e,message:f,onClose:g,thread:a}):i.jsx(c("CometPlaceholder.react"),{fallback:g!=null?i.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:g}):null,name:"MWV2MediaViewerContent.Controls",children:i.jsx(c("MWV2MediaViewerControls.react"),{attachment:e,message:f,onClose:g,thread:a})}),b[0]=e,b[1]=f,b[2]=g,b[3]=a,b[4]=h):h=b[4];return h}g["default"]=a}),98);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var b=d("react-compiler-runtime").c(10),e=a.attachment,f=a.isSecure;a=a.mediaRenderQpl;var g=j(d("MWV2MediaViewerContext.react").context);g=g.getPlayableUrl;var h;b[0]!==e||b[1]!==g||b[2]!==a?(h=g(e,"MediaViewerVideo",a),b[0]=e,b[1]=g,b[2]=a,b[3]=h):h=b[3];g=h;if(g!=null){b[4]===Symbol["for"]("react.memo_cache_sentinel")?(h={className:"x78zum5 x1iyjqo2 xmz0i5r"},b[4]=h):h=b[4];b[5]!==e.attachmentFbid||b[6]!==f||b[7]!==a||b[8]!==g?(h=i.jsx("div",babelHelpers["extends"]({},h,{children:i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:e.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,isSecure:f,mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:g,shouldForcePauseOnClick:!1})})),b[5]=e.attachmentFbid,b[6]=f,b[7]=a,b[8]=g,b[9]=h):h=b[9];return h}else{a.endFail("missing-playable-url");return null}}g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","FDSNullState.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("FDSNullState.react"),{headline:h._(/*BTDS*/"Sorry, this content isn't available right now")})})}),a[0]=b):b=a[0];return b}g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","cr:10022","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react");function a(a){var b=d("react-compiler-runtime").c(12),e=a.attachment,f=a.isSecure,g=a.onClose;a=a.threadType;if(e==null){var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[0]=h):h=b[0];return h}h=e.attachmentType;if(!((i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))){b[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[1]=h):h=b[1];return h}b[2]!==g?(h=c("gkx")("6691")&&k.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},{className:"x1ey2m1c xds687c x17qophe x10l6tqk x13vifvy"},{"data-testid":void 0,onClick:g})),b[2]=g,b[3]=h):h=b[3];var m;b[4]!==e||b[5]!==f||b[6]!==g||b[7]!==a?(m=k.jsx(l,{attachment:e,isSecure:f,onClose:g,threadType:a}),b[4]=e,b[5]=f,b[6]=g,b[7]=a,b[8]=m):m=b[8];b[9]!==h||b[10]!==m?(e=k.jsxs(k.Fragment,{children:[h,m]}),b[9]=h,b[10]=m,b[11]=e):e=b[11];return e}function l(a){var e=d("react-compiler-runtime").c(6),f=a.attachment,g=a.isSecure,h=a.onClose;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(f,a);var l=f.attachmentType,m;e[0]!==f||e[1]!==g||e[2]!==a||e[3]!==h||e[4]!==l?(m=(i||(i=d("I64"))).equal(l,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(l,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(b("cr:10022"),{attachment:f,mediaRenderQpl:a,onClickOutsideOfImage:h}):(i||(i=d("I64"))).equal(l,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:f,isSecure:g,mediaRenderQpl:a}):null,e[0]=f,e[1]=g,e[2]=a,e[3]=h,e[4]=l,e[5]=m):m=e[5];return m}g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometHideLayerOnEscape.react","CometPlaceholder.react","FDSBlurredBackgroundImage.react","I64","LSIntEnum","LSMessagingThreadTypeUtil","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControlsContainer.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","justknobx","react","react-compiler-runtime","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;var n=b.useContext,o=b.useEffect,p={mediaItem:{marginTop:"x14vqqas",marginInlineEnd:"xbmvrgn",marginBottom:"xod5an3",marginInlineStart:"x1diwwjn",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function q(a){var b=d("react-compiler-runtime").c(6);a=a.attachment;var e=n(d("MWV2MediaViewerContext.react").context);e=e.getPreviewUrl;var f;b[0]!==a||b[1]!==e?(f=e(a,"BlurredBackground"),b[0]=a,b[1]=e,b[2]=f):f=b[2];e=f;if(e!=null&&a!=null&&!(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))){b[3]===Symbol["for"]("react.memo_cache_sentinel")?(f={className:"x1ey2m1c xds687c x17qophe xuzhngd x10l6tqk x13vifvy"},b[3]=f):f=b[3];b[4]!==e?(a=m.jsx("div",babelHelpers["extends"]({},f,{children:m.jsx(c("FDSBlurredBackgroundImage.react"),{src:e})})),b[4]=e,b[5]=a):a=b[5];return a}else return null}function a(a){var b=d("react-compiler-runtime").c(66),e=a.initialAttachment,g=a.onClose,j=a.shouldShowMessengerLogo;a=a.thread;var k=n(d("MWChatAttachmentMediaState.react").context),l=k.canMoveBackward,r=k.canMoveForward,s=k.card,t=k.moveBackward,u=k.moveForward;k=k.shouldTriggerLoadMore;var v=n(d("MWV2MediaViewerContext.react").context),w=v.getPreviewUrl,x=v.loadMore,y=(i||(i=c("useReStore")))(),z=e==null?void 0:e.threadKey,A=e==null?void 0:e.messageId;b[0]!==y.tables.attachments||b[1]!==A||b[2]!==z?(v=function(){return d("ReQL").fromTableDescending(y.tables.attachments).getKeyRange(z,A)},b[0]=y.tables.attachments,b[1]=A,b[2]=z,b[3]=v):v=b[3];var B;b[4]!==y||b[5]!==A||b[6]!==z?(B=[y,A,z],b[4]=y,b[5]=A,b[6]=z,b[7]=B):B=b[7];v=d("ReQLSuspense").useFirst(v,B,f.id+":109")!=null;var C=s!=null?s.attachment:v?e:void 0;b[8]!==C||b[9]!==y.tables.messages?(B=function(){return(C==null?void 0:C.messageId)==null?d("ReQL").empty():d("ReQL").fromTableAscending(y.tables.messages.index("messageId")).getKeyRange(C.messageId)},b[8]=C,b[9]=y.tables.messages,b[10]=B):B=b[10];s=C==null?void 0:C.messageId;b[11]!==y.tables.messages||b[12]!==s?(v=[s,y.tables.messages],b[11]=y.tables.messages,b[12]=s,b[13]=v):v=b[13];e=d("ReQLSuspense").useFirst(B,v,f.id+":125");var D=k;b[14]!==x||b[15]!==D?(s=function(){D&&x()},B=[D,x],b[14]=x,b[15]=D,b[16]=s,b[17]=B):(s=b[16],B=b[17]);o(s,B);v=c("gkx")("1775");k=c("useShouldShowUnsupportedCodecFallback")(C);s=c("useShouldShowPlaybackErrorFallback")(C);b[18]!==C||b[19]!==s||b[20]!==k||b[21]!==g||b[22]!==a?(B=!k&&!s?m.jsx(c("MWV2MediaViewerItem.react"),{attachment:C,isSecure:d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType),onClose:g,threadType:a.threadType}):null,b[18]=C,b[19]=s,b[20]=k,b[21]=g,b[22]=a,b[23]=B):B=b[23];s=B;b[24]===Symbol["for"]("react.memo_cache_sentinel")?(k=c("justknobx")._("3491"),b[24]=k):k=b[24];B=k;b[25]!==C||b[26]!==e||b[27]!==g||b[28]!==a?(k=m.jsx(c("MWV2MediaViewerControlsContainer.react"),{attachment:C,message:e,onClose:g,thread:a}),b[25]=C,b[26]=e,b[27]=g,b[28]=a,b[29]=k):k=b[29];b[30]!==g?(e=B?null:m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:v?g:void 0}),b[30]=g,b[31]=e):e=b[31];b[32]!==C?(a=m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(q,{attachment:C})}),b[32]=C,b[33]=a):a=b[33];var E;b[34]===Symbol["for"]("react.memo_cache_sentinel")?(E=[p.mediaRow,v&&p.noOverflow],b[34]=E):E=b[34];l=!l;var F;b[35]===Symbol["for"]("react.memo_cache_sentinel")?(F=h._(/*BTDS*/"Previous photo"),b[35]=F):F=b[35];b[36]!==t||b[37]!==l?(F=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",invisible:l,label:F,onClick:t,testid:void 0})}),b[36]=t,b[37]=l,b[38]=F):F=b[38];b[39]!==s?(t=m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:v&&p.mediaItem,children:m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:s})}),b[39]=s,b[40]=t):t=b[40];l=!r;b[41]===Symbol["for"]("react.memo_cache_sentinel")?(s=h._(/*BTDS*/"Next photo"),b[41]=s):s=b[41];b[42]!==u||b[43]!==l?(r=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",invisible:l,label:s,onClick:u,testid:void 0})}),b[42]=u,b[43]=l,b[44]=r):r=b[44];b[45]!==F||b[46]!==t||b[47]!==r?(s=m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:v?0:void 0,verticalAlign:"stretch",xstyle:E,children:[F,t,r]})}),b[45]=F,b[46]=t,b[47]=r,b[48]=s):s=b[48];b[49]!==w?(u=m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:w})}),b[49]=w,b[50]=u):u=b[50];b[51]!==s||b[52]!==u?(l=m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[s,u]}),b[51]=s,b[52]=u,b[53]=l):l=b[53];b[54]!==j||b[55]!==k||b[56]!==e||b[57]!==a||b[58]!==l?(E=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:k,shouldShowMessengerLogo:j,children:[e,a,l]}),b[54]=j,b[55]=k,b[56]=e,b[57]=a,b[58]=l,b[59]=E):E=b[59];F=E;if(g!=null&&!v){b[60]!==F||b[61]!==g?(t=m.jsx(c("CometHideLayerOnEscape.react"),{onHide:g,children:F}),b[60]=F,b[61]=g,b[62]=t):t=b[62];return t}else{if(B){r=v?g:void 0;b[63]!==F||b[64]!==r?(w=m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:r,children:F}),b[63]=F,b[64]=r,b[65]=w):w=b[65];return w}return F}}g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var g=d("react-compiler-runtime").c(6),h=c("useAsyncReStore")(),i=d("MWThreadKey.react").useMWThreadKeyMemoized();i==null&&(i=b);b=d("MAWThreadCutover").useGetCutoverOpenThreadKey(i);var j=b!=null?b:i;g[0]!==h||g[1]!==j||g[2]!==e||g[3]!==a?(b=function(){e==null?void 0:e(),c("promiseDone")(h,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:j})},"readwrite",void 0,void 0,f.id+":40")})},i=[e,h,a,j],g[0]=h,g[1]=j,g[2]=e,g[3]=a,g[4]=b,g[5]=i):(b=g[4],i=g[5]);return d("Int64Hooks").useCallbackInt64(b,i)}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMediaGalleryEBTaggingUtils","MAWMiActOnActThreadReady","Promise","cr:20241","promiseDone","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){var e=d("react-compiler-runtime").c(16),f=a.earliestLoadedMediaMessageId,g=a.hasMoreBefore,k=a.mediaGalleryGroup,l=a.minTimestampMs,m=a.pageSize,n=a.qplLogger,o=a.threadKey,p=(j||(j=c("useReStore")))(),q;e[0]!==g||e[1]!==l?(a=function(){return g!=null&&g&&l!=null?(i||(i=d("I64"))).to_float(l):Number.MAX_SAFE_INTEGER},q=[g,l],e[0]=g,e[1]=l,e[2]=a,e[3]=q):(a=e[2],q=e[3]);var r=d("Int64Hooks").useCallbackInt64(a,q);e[4]!==k?(a=d("MAWMediaGalleryEBTaggingUtils").isMediaGalleryGroupSupportedForTaggedRestore(k),e[4]=k,e[5]=a):a=e[5];var s=a;e[6]!==p.tables||e[7]!==f||e[8]!==r||e[9]!==s||e[10]!==k||e[11]!==m||e[12]!==n||e[13]!==o?(q=function(){o!=null&&(n==null?void 0:n.logLoadMediaStart==null?void 0:n.logLoadMediaStart(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(p.tables,o,"useMAWLoadMoreThreadSharedAttachments",function(a,c){return(b("cr:20241")!=null&&s?b("cr:20241").MAWFetchAndPersistMedia(c,o,k,n):(h||(h=b("Promise"))).resolve()).then(function(){n==null?void 0:n.addPoint("fetch_from_maw_db",{"int":{mediaGalleryGroup:k}});return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:r(),mediaGalleryGroup:k,pageSize:m,threadJid:c})})})))},a=[o,p.tables,s,k,n,f,r,m],e[6]=p.tables,e[7]=f,e[8]=r,e[9]=s,e[10]=k,e[11]=m,e[12]=n,e[13]=o,e[14]=q,e[15]=a):(q=e[14],a=e[15]);return d("Int64Hooks").useCallbackInt64(q,a)}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","justknobx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useMemo,n=c("justknobx")._("1132");function a(a,b){b=b===void 0?{}:b;b=b.removeUnsentMessages;var e=b===void 0?!1:b,g=(h||(h=c("useReStore")))();b=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));var k=b.attachmentsRange,p=b.hasMoreBefore,r=b.minTimestampMs,s=b.query,t=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":75");if(e&&(b==null||b.isUnsent))return null;return b==null?{attachment:a}:{attachment:a,message:b}},[g,e]),u=d("ReQLSuspense").useArray(function(){var a=s.map(t).filter(Boolean);(r==null||(j||(j=d("I64"))).equal(r,(j||(j=d("I64"))).zero))&&(a=a.take(n));return a},[g,a,t,r],f.id+":93"),v=m(function(){var a=o(u);a.sort(q);return a},[u]);b=m(function(){return v.map(function(a){a=a.attachment;return a})},[v]);return[b,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),k,r,p]}function o(a){var b=p(a);return a.map(function(a){var c=a.attachment;a=a.message;var e=a==null?void 0:a.groupId,f=b.get(e!=null?e:"");if(e==null||f==null){return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:c.messageId,sortingMessagePrimarySortTS:(e=a==null?void 0:a.primarySortKey)!=null?e:c.timestampMs,sortingMessageSecondarySortTS:(e=(e=a==null?void 0:a.secondarySortKey)!=null?e:a==null?void 0:a.timestampMs)!=null?e:c.timestampMs}}}return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((e=a==null?void 0:a.groupIndex)!=null?e:(j||(j=d("I64"))).zero),sortingMessageId:f.messageId,sortingMessagePrimarySortTS:f.primarySortTs,sortingMessageSecondarySortTS:f.secondarySortTs}}})}function p(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function q(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g["default"]=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","qpl","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useEffect;b.useMemo;function a(a){var b=d("react-compiler-runtime").c(11),e=a.entrypoint,f=a.threadType;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=o(),b[0]=a):a=b[0];a=a;var g=a;b[1]!==e||b[2]!==f?(a=function(a){var b;k({entrypoint:e,instanceKey:g,isCutoverThread:(b=a==null?void 0:a.isCutoverThread)!=null?b:!1,isPreCutoverMedia:(b=a==null?void 0:a.isPreCutoverMedia)!=null?b:!1,threadType:f})},b[1]=e,b[2]=f,b[3]=a):a=b[3];a=a;var i;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(a){var b=a.fetchedMediaCount,c=a.isAlreadyPreloaded;a=a.startMediaCount;l({fetchedMediaCount:b,instanceKey:g,isAlreadyPreloaded:c,startMediaCount:a})},b[4]=i):i=b[4];i=i;var p;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(){m({instanceKey:g})},b[5]=p):p=b[5];var q=p;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(a,b){n({annotations:b,instanceKey:g,name:a})},b[6]=p):p=b[6];p=p;var r,s;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(r=function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),g);a&&q()}},s=[g,q],b[7]=r,b[8]=s):(r=b[7],s=b[8]);j(r,s);b[9]!==a?(r={addPoint:p,logLoadMediaCancel:q,logLoadMediaStart:a,logLoadMediaSuccess:i},b[9]=a,b[10]=r):r=b[10];s=r;return s}function k(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function l(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:e!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function m(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function n(a){var b=a.annotations,d=a.instanceKey;a=a.name;c("QPLUserFlow").addPoint(c("qpl")._(25300395,"1954"),a,{data:b,instanceKey:d})}function o(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","justknobx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e,f,g,h,j){var k=d("react-compiler-runtime").c(56),l=c("useMAWQuerySecureMediaAttachments")(a),m=l[0],n=l[1],o=l[2],p=l[3];l=l[4];var q;k[0]!==(o==null?void 0:o.lastLoadedMessageId)?(q=(o==null?void 0:o.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(o==null?void 0:o.lastLoadedMessageId):void 0,k[0]=o==null?void 0:o.lastLoadedMessageId,k[1]=q):q=k[1];q=q;var r=l!=null?l:!0,s;k[2]!==f.entrypoint||k[3]!==e?(s={entrypoint:f.entrypoint,threadType:e},k[2]=f.entrypoint,k[3]=e,k[4]=s):s=k[4];var t=c("useMWMediaLoadingQplLogger")(s);k[5]!==t?(f=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},k[5]=t,k[6]=f):f=k[6];e=f;s=q!=null?q:void 0;k[7]!==e||k[8]!==t?(f=babelHelpers["extends"]({},t,{logLoadMediaStart:e}),k[7]=e,k[8]=t,k[9]=f):f=k[9];k[10]!==l||k[11]!==g||k[12]!==p||k[13]!==j||k[14]!==a||k[15]!==s||k[16]!==f?(q={earliestLoadedMediaMessageId:s,hasMoreBefore:l,mediaGalleryGroup:g,minTimestampMs:p,pageSize:j,qplLogger:f,threadKey:a},k[10]=l,k[11]=g,k[12]=p,k[13]=j,k[14]=a,k[15]=s,k[16]=f,k[17]=q):q=k[17];e=c("useMAWLoadMoreThreadSharedAttachments")(q);l=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);g=l[0];p=l[2];j=l[4];k[18]===Symbol["for"]("react.memo_cache_sentinel")?(a=c("justknobx")._("2968"),k[18]=a):a=k[18];s=a;f=(j!=null?j:c("gkx")("6241"))?s:!1;k[19]!==t?(q=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},k[19]=t,k[20]=q):q=k[20];l=q;a=c("useLoadMoreThreadSharedAttachments.react")(n,b,l);k[21]!==o||k[22]!==r||k[23]!==e||k[24]!==m||k[25]!==t.logLoadMediaCancel||k[26]!==t.logLoadMediaSuccess?(j={attachmentsRange:o,hasMore:r,loadMore:e,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:m},k[21]=o,k[22]=r,k[23]=e,k[24]=m,k[25]=t.logLoadMediaCancel,k[26]=t.logLoadMediaSuccess,k[27]=j):j=k[27];s=d("MWSharedAttachmentsSectionHooks").useLoader(j);q=s[0];n=s[1];b=s[2];l=r||q;k[28]!==p||k[29]!==f||k[30]!==a||k[31]!==g||k[32]!==t.logLoadMediaCancel||k[33]!==t.logLoadMediaSuccess||k[34]!==l?(o={attachmentsRange:p,hasMore:f,loadMore:a,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:g,skipInitialLoad:l},k[28]=p,k[29]=f,k[30]=a,k[31]=g,k[32]=t.logLoadMediaCancel,k[33]=t.logLoadMediaSuccess,k[34]=l,k[35]=o):o=k[35];e=d("MWSharedAttachmentsSectionHooks").useLoader(o);j=e[0];s=e[1];p=e[2];if(r||q||h===!0){k[36]!==b||k[37]!==r||k[38]!==q||k[39]!==m||k[40]!==n?(a={attachments:m,completedFirstLoad:b,hasMore:r,isLoadingMore:q,onLoadMore:n},k[36]=b,k[37]=r,k[38]=q,k[39]=m,k[40]=n,k[41]=a):a=k[41];return a}else if(f||j){k[42]!==g||k[43]!==m?(l=m.concat(g),k[42]=g,k[43]=m,k[44]=l):l=k[44];k[45]!==p||k[46]!==f||k[47]!==j||k[48]!==s||k[49]!==l?(o={attachments:l,completedFirstLoad:p,hasMore:f,isLoadingMore:j,onLoadMore:s},k[45]=p,k[46]=f,k[47]=j,k[48]=s,k[49]=l,k[50]=o):o=k[50];return o}else{k[51]!==g||k[52]!==m?(e=m.concat(g),k[51]=g,k[52]=m,k[53]=e):e=k[53];k[54]!==e?(h={attachments:e,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:i},k[54]=e,k[55]=h):h=k[55];return h}}function i(){}g["default"]=a}),98);
__d("useMWMediaGalleryRestoreStatus",["Int64Hooks","LSMessagingThreadTypeUtil","MAWFTSRestoreSync","MAWMiActOnActThreadReady","MWEBEntrypointsKillswitch.enum","MWMessageSearchStatusTypes","cr:11999","justknobx","promiseDone","react","react-compiler-runtime","useMWEBBackupState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||d("react")).useState;function a(a){var e=d("react-compiler-runtime").c(12),f=a.threadKey;a=a.threadType;var g=(h||(h=c("useReStore")))(),i=j(null),l=i[0],m=i[1];e[0]===Symbol.for("react.memo_cache_sentinel")?(i={entrypoint:c("MWEBEntrypointsKillswitch.enum").MEDIA_GALLERY_RESTORE},e[0]=i):i=e[0];i=c("useMWEBBackupState")(i);var n=b("cr:11999")(l,"media"),o;e[1]!==a?(o=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a),e[1]=a,e[2]=o):o=e[2];var p=o;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=d("MAWFTSRestoreSync").getMediaRestoreSync(),e[3]=a):a=e[3];var q=a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=function(){return q.isStarted()},e[4]=o):o=e[4];a=j(o);o=a[0];var r=a[1];e[5]===Symbol.for("react.memo_cache_sentinel")?(a=function(){return q.isEBMaybeAvailable()},e[5]=a):a=e[5];a=j(a);var s=a[0],t=a[1];e[6]===Symbol.for("react.memo_cache_sentinel")?(a=function(){return q.getActiveThreadId()},e[6]=a):a=e[6];a=j(a);var u=a[0],v=a[1];a=j(-1);var w=a[0],x=a[1];a=j(!1);var y=a[0],z=a[1],A;e[7]!==g.tables||e[8]!==p||e[9]!==f?(a=function(){var a;(a=d("MAWFTSRestoreSync")).MAWGalleryEventEmitter.addListener("isSyncStarted",function(a){return r(a)});a.MAWGalleryEventEmitter.addListener("isEBMaybeAvailable",function(a){return t(a)});a.MAWGalleryEventEmitter.addListener("activeThreadJid",function(a){return v(a)});a.MAWGalleryEventEmitter.addListener("isPersisting",function(a){return z(a)});a.MAWGalleryEventEmitter.addListener("restoredUntilMs",function(a){x(a)});a=async function(){await d("MAWMiActOnActThreadReady").onActThreadReady(g.tables,f,"useMWMediaGalleryRestoreStatus",function(a,b){m(b);return Promise.resolve()})};p?c("promiseDone")(a()):m(null);return k},A=[g.tables,p,f],e[7]=g.tables,e[8]=p,e[9]=f,e[10]=a,e[11]=A):(a=e[10],A=e[11]);d("Int64Hooks").useEffectInt64(a,A);if(l!=null&&q.getDoneThreads().has(l))return d("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE;e=l!=null&&u===l;if(!p)return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_REQUIRED;if(i!==3)return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;if(o){if(!s||!e)return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;a=c("justknobx")._("3245")?w===0:n===0;return a&&!y?d("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE:d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS}else return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING}function k(){d("MAWFTSRestoreSync").MAWGalleryEventEmitter.removeAllListeners()}g.default=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(h||d("react")).useCallback;function a(){return k}function k(a){if(a==null)return;return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["react","react-compiler-runtime","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useMWV2MediaViewerOpenPlayableUrl")(),e;a[0]!==b?(e=function(a,c,d){a=b(a,c,d);if(a==null)return;c=new URL(a);c.searchParams.set("dl","1");return c.toString()},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931").getThumbnailBlob_CausesSuspense(a,c,d)}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWMessageSearchStatusTypes","MWV2MediaViewerContext.react","cr:14186","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var e=d("react-compiler-runtime").c(30),f=a.children,g=a.initialAttachment,h=a.openThreadKey,k=a.secureThreadKey;a=a.threadType;var l;e[0]!==k||e[1]!==a?(l={threadKey:k,threadType:a},e[0]=k,e[1]=a,e[2]=l):l=e[2];b("cr:14186")(l);e[3]!==k||e[4]!==a?(l={threadKey:k,threadType:a},e[3]=k,e[4]=a,e[5]=l):l=e[5];l=c("useMWMediaGalleryRestoreStatus")(l);l=l===d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;var m;e[6]===Symbol["for"]("react.memo_cache_sentinel")?(m={entrypoint:"media_viewer"},e[6]=m):m=e[6];var n;e[7]===Symbol["for"]("react.memo_cache_sentinel")?(n=c("justknobx")._("3233"),e[7]=n):n=e[7];k=c("useMAWLoadMoreCutoverThreadSharedAttachments")(k,h,a,m,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,l,n);h=k.attachments;a=k.onLoadMore;var o=j,p=c("useMWV2MediaViewerOpenPreviewUrl")(),q=c("useMWV2MediaViewerOpenPlayableUrl")(),r=c("useMWV2MediaViewerOpenDownloadUrl")(),s=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),t=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();e[8]!==p||e[9]!==s?(m=function(a,b,c){if(!a)return"";return!o(a)?p(a,b,c):s(a,b,c)},e[8]=p,e[9]=s,e[10]=m):m=e[10];l=m;e[11]!==q||e[12]!==t?(n=function(a,b,c){if(a==null)return"";return!o(a)?q(a,b,c):t(a,b,c)},e[11]=q,e[12]=t,e[13]=n):n=e[13];k=n;e[14]!==r||e[15]!==t?(m=function(a,b,c){if(a==null)return"";return!o(a)?r(a,b,c):t(a,b,c)},e[14]=r,e[15]=t,e[16]=m):m=e[16];n=m;e[17]!==h||e[18]!==f||e[19]!==k||e[20]!==l||e[21]!==g?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:o,getPlayableUrl:k,getPreviewUrl:l,initialAttachment:g,children:f}),e[17]=h,e[18]=f,e[19]=k,e[20]=l,e[21]=g,e[22]=m):m=e[22];e[23]!==h||e[24]!==n||e[25]!==k||e[26]!==l||e[27]!==a||e[28]!==m?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:n,getPlayableUrl:k,getPreviewUrl:l,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:h,children:m}),e[23]=h,e[24]=n,e[25]=k,e[26]=l,e[27]=a,e[28]=m,e[29]=f):f=e[29];return f}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(22),e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0],l=g[1],m=g[2];g=g[4];var n;b[0]!==a.threadType?(n={entrypoint:"media_viewer",threadType:a.threadType},b[0]=a.threadType,b[1]=n):n=b[1];n=c("useMWMediaLoadingQplLogger")(n);l=c("useLoadMoreThreadSharedAttachments.react")(l,a.threadKey,n.logLoadMediaStart);a=g!=null?g:!0;b[2]!==m||b[3]!==l||b[4]!==h||b[5]!==n.logLoadMediaCancel||b[6]!==n.logLoadMediaSuccess||b[7]!==a?(g={attachmentsRange:m,hasMore:a,loadMore:l,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:h},b[2]=m,b[3]=l,b[4]=h,b[5]=n.logLoadMediaCancel,b[6]=n.logLoadMediaSuccess,b[7]=a,b[8]=g):g=b[8];m=d("MWSharedAttachmentsSectionHooks").useLoader(g);l=m[1];n=c("useMWV2MediaViewerOpenPreviewUrl")();a=c("useMWV2MediaViewerOpenPlayableUrl")();g=c("useMWV2MediaViewerOpenDownloadUrl")();m=k;b[9]!==e||b[10]!==a||b[11]!==n||b[12]!==f||b[13]!==h?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:a,getPreviewUrl:n,initialAttachment:f,children:e}),b[9]=e,b[10]=a,b[11]=n,b[12]=f,b[13]=h,b[14]=m):m=b[14];b[15]!==g||b[16]!==a||b[17]!==n||b[18]!==l||b[19]!==h||b[20]!==m?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:g,getPlayableUrl:a,getPreviewUrl:n,heroLoggingComponent:j,loadMore:l,media:h,children:m}),b[15]=g,b[16]=a,b[17]=n,b[18]=l,b[19]=h,b[20]=m,b[21]=e):e=b[21];return e}function j(a){return i.jsx(c("CometHero.react"),{description:a})}j.displayName=j.name+" [from "+f.id+"]";function k(){return!1}g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:14186","cr:5709","cr:5931","cr:5970","emptyFunction","justknobx","react","react-compiler-runtime","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){return j}function j(){}var k=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=d("react-compiler-runtime").c(34),f=a.children,g=a.initialAttachment;a=a.thread;var h=c("useMAWQuerySecureMediaAttachments")(a.threadKey),j=h[0],m=h[2],n=h[3];h=h[4];b("cr:14186")(a);var o=h!=null?h:!0;e[0]!==a.threadType?(h={entrypoint:"media_viewer",threadType:a.threadType},e[0]=a.threadType,e[1]=h):h=e[1];h=c("useMWMediaLoadingQplLogger")(h);if(e[2]!==(m==null?void 0:m.lastLoadedMessageId)){var p;p=(p=d("MAWDbMsg").toMsgId((p=m==null?void 0:m.lastLoadedMessageId)!=null?p:""))!=null?p:void 0;e[2]=m==null?void 0:m.lastLoadedMessageId;e[3]=p}else p=e[3];var q;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(q=c("justknobx")._("3233"),e[4]=q):q=e[4];e[5]!==o||e[6]!==n||e[7]!==h||e[8]!==p||e[9]!==a.threadKey?(q={earliestLoadedMediaMessageId:p,hasMoreBefore:o,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,minTimestampMs:n,pageSize:q,qplLogger:h,threadKey:a.threadKey},e[5]=o,e[6]=n,e[7]=h,e[8]=p,e[9]=a.threadKey,e[10]=q):q=e[10];var r=k(q);e[11]!==o||e[12]!==r?(n=function(){o&&r()},e[11]=o,e[12]=r,e[13]=n):n=e[13];p=n;e[14]!==m||e[15]!==o||e[16]!==p||e[17]!==j||e[18]!==h.logLoadMediaCancel||e[19]!==h.logLoadMediaSuccess?(a={attachmentsRange:m,hasMore:o,loadMore:p,logLoadMediaCancel:h.logLoadMediaCancel,logLoadMediaSuccess:h.logLoadMediaSuccess,media:j},e[14]=m,e[15]=o,e[16]=p,e[17]=j,e[18]=h.logLoadMediaCancel,e[19]=h.logLoadMediaSuccess,e[20]=a):a=e[20];q=d("MWSharedAttachmentsSectionHooks").useLoader(a);n=q[1];m=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")();p=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();h=l;if(b("cr:5970")==null||b("cr:5931")==null){e[21]===Symbol["for"]("react.memo_cache_sentinel")?(a=i.jsx(c("MWV2MediaViewerNullState.react"),{}),e[21]=a):a=e[21];return a}e[22]!==f||e[23]!==p||e[24]!==m||e[25]!==g||e[26]!==j?(q=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:j,getIsSecureThread:h,getPlayableUrl:p,getPreviewUrl:m,initialAttachment:g,children:f}),e[22]=f,e[23]=p,e[24]=m,e[25]=g,e[26]=j,e[27]=q):q=e[27];e[28]!==p||e[29]!==m||e[30]!==n||e[31]!==j||e[32]!==q?(a=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:p,getPlayableUrl:p,getPreviewUrl:m,heroLoggingComponent:c("emptyFunction"),loadMore:n,media:j,children:q}),e[28]=p,e[29]=m,e[30]=n,e[31]=j,e[32]=q,e[33]=a):a=e[33];return a}function l(){return!0}g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","FocusRegion.react","FocusWithinHandler.react","I64","LSMessagingThreadTypeUtil","MAWMediaGalleryM2Utils","MAWThreadCutover","MWFocusTable.react","MWLSThread","MWLSThreadDisplayContext","MWPThreadCapabilitiesContext","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","XPlatReactFocusRegion.react","focusScopeQueries","gkx","justknobx","react","react-compiler-runtime","requireDeferred","useMWMediaViewerOpenQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;b.useCallback;var k=b.useEffect,l=b.useId,m=c("requireDeferred")("MAWFTSRestoreSync").__setRef("MWV2MediaViewer.react");function a(a){var b=d("react-compiler-runtime").c(61),e=a.attachment,f=a.onClose;a=a.shouldShowMessengerLogo;var g=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),h=g.endSuccess,n;b[0]!==h?(g=function(){h()},n=[h],b[0]=h,b[1]=g,b[2]=n):(g=b[1],n=b[2]);k(g,n);g=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();var o=g==="ChatTab";b[3]!==o?(n=function(){if(!c("justknobx")._("3195")||!d("MAWMediaGalleryM2Utils").isMediaGalleryM2Enabled())return;m.onReady(function(a){a=a.getFTSRestoreSync;a=a();o&&(a.setIsStarted(!1),a.setShouldPauseRestore(!0))})},b[3]=o,b[4]=n):n=b[4];var p=n;g=d("MWLSThread").useThread(e.threadKey);n=d("MWPThreadCapabilitiesContext").Provider;var q=l(),r;b[5]!==q?(r=function(a){a||d("FocusRegion.react").focusRegionById(q,d("MWFocusTable.react").tabbableScopeQuery)},b[5]=q,b[6]=r):r=b[6];r=r;var s=d("MAWThreadCutover").useGetCutoverOpenThreadKey(e.threadKey),t=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(s==null?e.threadKey:void 0);if(g==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(e.threadKey));var u;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(u=j.jsx(c("MWV2MediaViewerNullState.react"),{}),b[7]=u):u=b[7];return u}u=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType);if(s!=null||t!=null){s=s!=null?s:g.threadKey;t=t!=null?t:g.threadKey;var v;b[8]!==f||b[9]!==p?(v=function(){p(),f&&f()},b[8]=f,b[9]=p,b[10]=v):v=b[10];var w;b[11]!==e||b[12]!==a||b[13]!==v||b[14]!==g?(w=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:v,shouldShowMessengerLogo:a,thread:g}),b[11]=e,b[12]=a,b[13]=v,b[14]=g,b[15]=w):w=b[15];b[16]!==e||b[17]!==s||b[18]!==t||b[19]!==w||b[20]!==g.threadType?(v=j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:e,openThreadKey:s,secureThreadKey:t,threadType:g.threadType,children:w}),b[16]=e,b[17]=s,b[18]=t,b[19]=w,b[20]=g.threadType,b[21]=v):v=b[21];s=v;b[22]!==s||b[23]!==g?(t=c("gkx")("1372")?j.jsx(n,{thread:g,children:s}):s,b[22]=s,b[23]=g,b[24]=t):t=b[24];w=t;b[25]!==w||b[26]!==q?(v=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:q,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:w}),b[25]=w,b[26]=q,b[27]=v):v=b[27];s=v;b[28]!==s||b[29]!==r?(t=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:r,onFocusVisibleChange:r,children:s}):s,b[28]=s,b[29]=r,b[30]=t):t=b[30];return t}if(u){b[31]!==f||b[32]!==p?(w=function(){p(),f&&f()},b[31]=f,b[32]=p,b[33]=w):w=b[33];b[34]!==e||b[35]!==a||b[36]!==w||b[37]!==g?(v=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:w,shouldShowMessengerLogo:a,thread:g}),b[34]=e,b[35]=a,b[36]=w,b[37]=g,b[38]=v):v=b[38];b[39]!==e||b[40]!==v||b[41]!==g?(s=j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:e,thread:g,children:v}),b[39]=e,b[40]=v,b[41]=g,b[42]=s):s=b[42];t=s;b[43]!==t||b[44]!==g?(u=c("gkx")("1372")?j.jsx(n,{thread:g,children:t}):t,b[43]=t,b[44]=g,b[45]=u):u=b[45];w=u;b[46]!==w||b[47]!==q?(v=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:q,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:w}),b[46]=w,b[47]=q,b[48]=v):v=b[48];s=v;b[49]!==s||b[50]!==r?(n=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:r,onFocusVisibleChange:r,children:s}):s,b[49]=s,b[50]=r,b[51]=n):n=b[51];return n}b[52]!==e||b[53]!==f||b[54]!==a||b[55]!==g?(t=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:f,shouldShowMessengerLogo:a,thread:g}),b[52]=e,b[53]=f,b[54]=a,b[55]=g,b[56]=t):t=b[56];b[57]!==e||b[58]!==t||b[59]!==g?(u=j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:e,thread:g,children:t}),b[57]=e,b[58]=t,b[59]=g,b[60]=u):u=b[60];return u}g["default"]=a}),98);
__d("MWV2MediaViewerAspectRatioContainer.react",["BaseAspectRatioContainer.react","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={containerMaxSize:function(a,b){return[{aspectRatio:b==null?null:"x1f7gzso",marginTop:"xr1yuqi",marginInlineEnd:"x11t971q",marginBottom:"x4ii5y1",marginInlineStart:"xvc5jky",maxHeight:"min(calc(100vh - 76px),"+(a!=null?a:1e4)+"px)"==null?null:"x1kb659o",$$css:!0},{"--aspectRatio":b!=null?b:void 0,"--maxHeight":function(a){return typeof a==="number"?a+"px":a!=null?a:void 0}("min(calc(100vh - 76px),"+(a!=null?a:1e4)+"px)")}]}};function a(a){var b=d("react-compiler-runtime").c(14),e=a.children,f=a.height,g=a.onClickOutsideOfChildren;a=a.width;a=a!=null&&f!=null?a/f:1;var i;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(i={className:"x5yr21d xh8yej3"},b[0]=i):i=b[0];var m;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(m={className:"x1m82ljr x8cgc45 xr1yuqi x11t971q x4ii5y1 xvc5jky x1n2onr6 xtzzx4i xwa60dl x11lhmoz"},b[1]=m):m=b[1];var n;b[2]!==a||b[3]!==f?(n=(h||(h=c("stylex"))).props(k.containerMaxSize(f,a)),b[2]=a,b[3]=f,b[4]=n):n=b[4];b[5]!==a||b[6]!==e?(f=j.jsx(c("BaseAspectRatioContainer.react"),{aspectRatio:a,children:e}),b[5]=a,b[6]=e,b[7]=f):f=b[7];b[8]!==n||b[9]!==f?(a=j.jsx("div",babelHelpers["extends"]({},m,{children:j.jsx("div",babelHelpers["extends"]({},n,{"aria-hidden":!0,onClick:l,children:f}))})),b[8]=n,b[9]=f,b[10]=a):a=b[10];b[11]!==g||b[12]!==a?(e=j.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},i,{onClick:g,children:a})),b[11]=g,b[12]=a,b[13]=e):e=b[13];return e}function l(a){a.cancelBubble=!0,a.stopPropagation()}g["default"]=a}),98);
__d("MWV2MediaViewerItemImageV2.react",["fbt","BaseImage.react","I64","MWAnimatedImageControlsUtil","MWAnimatedImageThumbnailWithPlayButton.react","MWV2MediaViewerAspectRatioContainer.react","MWV2MediaViewerContext.react","MWXIconHd","MWXIconStrict.react","MWXPressable.react","MWXThreadThemeColor","MessagingAttachmentType","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||(i=d("react"));b=i;var l=b.useContext,m=b.useEffect,n=b.useRef,o=b.useState;function a(a){var b=d("react-compiler-runtime").c(34),e=a.attachment,f=a.mediaRenderQpl;a=a.onClickOutsideOfImage;var g=d("MWAnimatedImageControlsUtil").useGetMessengerAutoplaySetting(),i=l(d("MWV2MediaViewerContext.react").context),q=i.getPlayableUrl;i=i.heroLoggingComponent;var r=n(null),s=o(!1),t=s[0],u=s[1],v;b[0]!==f?(s=function(){var a;r.current!=null&&((a=r.current)==null?void 0:a.complete)&&f.endSuccess()},v=[f],b[0]=f,b[1]=s,b[2]=v):(s=b[1],v=b[2]);m(s,v);b[3]!==e.previewHeight||b[4]!==e.previewHeightLarge?(s=e.previewHeightLarge!=null?(j||(j=d("I64"))).to_float(e.previewHeightLarge):e.previewHeight!=null?(j||(j=d("I64"))).to_float(e.previewHeight):void 0,b[3]=e.previewHeight,b[4]=e.previewHeightLarge,b[5]=s):s=b[5];v=s;b[6]!==e.previewWidth||b[7]!==e.previewWidthLarge?(s=e.previewWidthLarge!=null?(j||(j=d("I64"))).to_float(e.previewWidthLarge):e.previewWidth!=null?(j||(j=d("I64"))).to_float(e.previewWidth):void 0,b[6]=e.previewWidth,b[7]=e.previewWidthLarge,b[8]=s):s=b[8];s=s;var w=(j||(j=d("I64"))).to_int32(e.attachmentType)===c("MessagingAttachmentType").ANIMATED_IMAGE,x;b[9]!==e||b[10]!==q||b[11]!==f?(x=q(e,"MediaViewerImage",f),b[9]=e,b[10]=q,b[11]=f,b[12]=x):x=b[12];q=x;if(q!=null){var y=w&&g!==d("MWAnimatedImageControlsUtil").MWAutoplayAnimationsSetting.ON;b[13]!==i?(x=i("MWV2MediaViewerImage"),b[13]=i,b[14]=x):x=b[14];b[15]!==e||b[16]!==v||b[17]!==t||b[18]!==f||b[19]!==y||b[20]!==q||b[21]!==s?(w=y?t===!1?k.jsx(d("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{connectBottom:!1,connectTop:!1,dbAttachment:e,entryPoint:d("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:f,message:null,onPlay:function(){return u(!0)},outgoing:!1,previewHeight:v,previewWidth:s}):k.jsx(c("MWXPressable.react"),{"aria-label":h._(/*BTDS*/"Pause GIF"),hideHoverOverlay:!0,onPress:function(){y&&u(!1)},children:k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){f.endFail("load-image-error")},onLoad:function(){f.endSuccess()},ref:r,src:q,width:"100%"})}):k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){f.endFail("load-image-error")},onLoad:function(){f.endSuccess()},ref:r,src:q,width:"100%"}),b[15]=e,b[16]=v,b[17]=t,b[18]=f,b[19]=y,b[20]=q,b[21]=s,b[22]=w):w=b[22];b[23]!==e?(g=k.jsx(p,{attachment:e}),b[23]=e,b[24]=g):g=b[24];b[25]!==x||b[26]!==w||b[27]!==g?(i=k.jsxs(k.Fragment,{children:[x,w,g]}),b[25]=x,b[26]=w,b[27]=g,b[28]=i):i=b[28];b[29]!==v||b[30]!==a||b[31]!==i||b[32]!==s?(t=k.jsx(c("MWV2MediaViewerAspectRatioContainer.react"),{height:v,onClickOutsideOfChildren:a,width:s,children:i}),b[29]=v,b[30]=a,b[31]=i,b[32]=s,b[33]=t):t=b[33];return t}else{f.endFail("missing-playable-url");return null}}function p(a){var b=d("react-compiler-runtime").c(3);a=a.attachment;a=a;a=a.isHd===!0;if(!a)return null;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"x78zum5 x5yr21d x10l6tqk xh8yej3"},e={className:"x92rtbv x10l6tqk xomnu4r"},b[0]=a,b[1]=e):(a=b[0],e=b[1]);b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",babelHelpers["extends"]({},a,{children:k.jsx("div",babelHelpers["extends"]({},e,{children:k.jsx(c("MWXIconStrict.react"),{color:d("MWXThreadThemeColor").mwxThreadThemeColor("rgba(255,255,255,0.7)"),icon:c("MWXIconHd"),size:24})}))})),b[2]=a):a=b[2];return a}g["default"]=a}),226);
__d("MWV2MediaViewerThreadCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","cr:14186","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var e=d("react-compiler-runtime").c(27),f=a.children,g=a.initialAttachment,h=a.openThreadKey,k=a.secureThreadKey;a=a.threadType;var l;e[0]!==k||e[1]!==a?(l={threadKey:k,threadType:a},e[0]=k,e[1]=a,e[2]=l):l=e[2];b("cr:14186")(l);e[3]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:"media_viewer"},e[3]=l):l=e[3];var m;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("justknobx")._("3233"),e[4]=m):m=e[4];k=c("useMAWLoadMoreCutoverThreadSharedAttachments")(k,h,a,l,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,!1,m);h=k.attachments;a=k.onLoadMore;var n=j,o=c("useMWV2MediaViewerOpenPreviewUrl")(),p=c("useMWV2MediaViewerOpenPlayableUrl")(),q=c("useMWV2MediaViewerOpenDownloadUrl")(),r=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),s=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();e[5]!==o||e[6]!==r?(l=function(a,b,c){if(!a)return"";return!n(a)?o(a,b,c):r(a,b,c)},e[5]=o,e[6]=r,e[7]=l):l=e[7];m=l;e[8]!==p||e[9]!==s?(k=function(a,b,c){if(a==null)return"";return!n(a)?p(a,b,c):s(a,b,c)},e[8]=p,e[9]=s,e[10]=k):k=e[10];l=k;e[11]!==q||e[12]!==s?(k=function(a,b,c){if(a==null)return"";return!n(a)?q(a,b,c):s(a,b,c)},e[11]=q,e[12]=s,e[13]=k):k=e[13];k=k;var t;e[14]!==h||e[15]!==f||e[16]!==l||e[17]!==m||e[18]!==g?(t=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:n,getPlayableUrl:l,getPreviewUrl:m,initialAttachment:g,children:f}),e[14]=h,e[15]=f,e[16]=l,e[17]=m,e[18]=g,e[19]=t):t=e[19];e[20]!==h||e[21]!==k||e[22]!==l||e[23]!==m||e[24]!==a||e[25]!==t?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:k,getPlayableUrl:l,getPreviewUrl:m,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:h,children:t}),e[20]=h,e[21]=k,e[22]=l,e[23]=m,e[24]=a,e[25]=t,e[26]=f):f=e[26];return f}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("useMWInboxMediaRestoreLoop",["Int64Hooks","LSMessagingThreadTypeUtil","MAWMiActOnActThreadReadyDeferred","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useState,j=c("requireDeferred")("MAWFTSRestoreSync").__setRef("useMWInboxMediaRestoreLoop");function a(a){var b=d("react-compiler-runtime").c(14),e=a.threadKey,f=c("useAsyncReStore")(),g=i(null),h=g[0],k=g[1],l;b[0]!==f||b[1]!==h||b[2]!==a.threadType||b[3]!==e?(g=function(){var b=async function(){var a=await f;c("promiseDone")(c("MAWMiActOnActThreadReadyDeferred")(a,e,"mediaRestore",function(a,b){j.onReady(function(a){a=a.getMediaRestoreSync;a().setActiveThreadId(b);c("promiseDone")(a().startMediaSyncingLoop());k(a())});return Promise.resolve()}))};d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)&&c("promiseDone")(b());return function(){h==null?void 0:h.setIsStarted(!1),h==null?void 0:h.setShouldPauseRestore(!0)}},l=[f,h,a.threadType,e],b[0]=f,b[1]=h,b[2]=a.threadType,b[3]=e,b[4]=g,b[5]=l):(g=b[4],l=b[5]);d("Int64Hooks").useEffectInt64(g,l);b[6]!==h?(g=function(){h!=null&&(h.resetEBAvailability(),h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[6]=h,b[7]=g):g=b[7];var m=g;b[8]!==h?(l=function(){h!=null&&(h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[8]=h,b[9]=l):l=b[9];var n=l;b[10]!==m||b[11]!==n?(g=function(){return{onEBOnboarded:m,startMediaSync:n}},l=[m,n],b[10]=m,b[11]=n,b[12]=g,b[13]=l):(g=b[12],l=b[13]);return d("Int64Hooks").useMemoInt64(g,l)}g.default=a}),98);
__d("useMWMaybeInboxMediaRestoreLoop",["cr:20239","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=d("react-compiler-runtime").c(2);a=b("cr:20239")(a);var e;c[0]!==a?(e=a!=null?a:{onEBOnboarded:i,startMediaSync:h},c[0]=a,c[1]=e):e=c[1];return e}function h(){}function i(){}g["default"]=a}),98);