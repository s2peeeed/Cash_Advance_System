;/*FB_PKG_DELIM*/

__d("MAWBridgeSearchMsg",["MAWCurrentUser","MAWVault","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b===void 0&&(b=!0);var c=a,e=d("MAWCurrentUser").getID(),f=a.author,g=a.externalId,h=a.msgId,i=a.threadJid;if(i==null)return null;var j=c.content;c=c.sortOrderMs;i={chatJid:i,externalId:g,msg:{msgId:h,sender:d("WAJids").authorToUserId(f,e),ts:a.canonicalTs},sortOrderMs:c};g=j;return babelHelpers["extends"]({},i,{msg:babelHelpers["extends"]({},i.msg,{content:g!=null?d("MAWVault").isVaulted(g)?b?g:d("MAWVault").unvault(g):b?d("MAWVault").vault(g):g:void 0})})}b="message_content_search";c="non_message_content_search";g.createBridgeSearchMsg=a;g.MESSAGE_CONTENT_SEARCH=b;g.NON_MESSAGE_CONTENT_SEARCH=c}),98);
__d("MAWBridgeTraceEvent",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["ReceivedReceipt","ReceivedSent","FlowEndForFailure","FlowEndForSuccess"]);c=a;f["default"]=c}),66);
__d("MAWEphemeralUtils",["MAWLocalizationType","MAWUserJidWrapper","WAArmadilloApplication.pb","WAJids","err"],(function(a,b,c,d,e,f,g){"use strict";var h=60,i=60*h,j=24*i;function a(a,b,c,e){var f=[],g=b===j,k=a===d("MAWUserJidWrapper").getMyUserJid();if(e)e=d("MAWLocalizationType").LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET;else if(!k||a==null)b===0?e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF:b<h?(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS,f.push(b.toString())):b<i?(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES,f.push((b/h).toString())):b<j||g?(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS,f.push((b/i).toString())):(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS,f.push((b/j).toString()));else{a=d("WAJids").extractUserId(a).toString();b===0?k?e=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF:(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF,f.push(a)):b<h?(k?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS,f.push(a)),f.push(b.toString())):b<i?(k?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES,f.push(a)),f.push((b/h).toString())):b<j||g?(k?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS,f.push(a)),f.push((b/i).toString())):(k?e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS:(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS,f.push(a)),f.push((b/j).toString()))}return{adminMsgContent:f,adminType:e,version:1}}function b(a,b,e){var f,g=[];b=d("WAJids").extractUserId(b).toString();switch(a){case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE:e?f=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT:(f=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT,g.push(b));break;case d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREEN_RECORDING:e?f=d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_RECORD_SCREEN:(f=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN,g.push(b));break;default:throw c("err")("Received unexpected screenshot action type")}return{ephemeralScreenshotActionContent:g,ephemeralScreenshotActionType:f}}g.getEphemeralSettingChangeData=a;g.getEphemeralScreenshotActionData=b}),98);
__d("MAWFTSIsMessageValidForSearch",["MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.ephemeralSetting!=null&&a.ephemeralSetting.ephemeralExpirationInSec>0}function a(a){var b=a.msgContent,c=a.sortOrderMs,e=a.type;b=b==null?void 0:b.content;if(b==null||c==null)return null;if(e!==d("MAWMsgType").MSG_TYPE.TEXT&&e!==d("MAWMsgType").MSG_TYPE.XMA)return null;return h(a)?null:{content:b,sortOrderMs:c}}g.verifyMessageValidity=a}),98);
__d("MAWUpdateClientRestoreStatusOperationType",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;f.upsertClientRestoreStatus=a;f.markCompleteClientRestoreStatus=b}),66);
__d("MAWWritePinMessageAdminMsgContent",["MAWAdminMsgType","MAWCurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a===d("MAWCurrentUser").getID()?d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_PINNED_MESSAGE:d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_PINNED_MESSAGE;a=b===d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_PINNED_MESSAGE?[a]:[];return{adminMsgContent:a,adminType:b,version:1}}g.getAdminMsgContent=a}),98);
__d("MAWWriteThreadHotlikeCustomizationAdminMsgContent",["MAWAdminMsgType","MAWCurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=a===d("MAWCurrentUser").getID();c=c?d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE;var e=[];c===d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE?e.push(b):e.push(a,b);return{adminMsgContent:e,adminType:c,version:1}}g.getAdminMsgContent=a}),98);
__d("MAWWriteThreadNicknameCustomizationAdminMsgContent",["MAWAdminMsgType","MAWCurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=d("MAWCurrentUser").getID(),f=a===e&&a!==b,g=b===e&&b!==a,h=b===a&&e===b;e=b===a&&e!==b;var i;h&&c.length>0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_SET_OWN_NICKNAME:h&&c.length===0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:e&&c.length>0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_SET_OWN_NICKNAME:e&&c.length===0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:f&&c.length>0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:f&&c.length===0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:g&&c.length>0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:g&&c.length===0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:c.length>0?i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:i=d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME;h=[];switch(i){case d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:h.push(b,c);break;case d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:case d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_SET_OWN_NICKNAME:h.push(a,c);break;case d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_SET_OWN_NICKNAME:h.push(c);break;case d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:case d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:h.push(b);break;case d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:h.push(a);break;case d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:case d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:h.push(a,b,c);break;default:break}return{adminMsgContent:h,adminType:i,version:1}}g.getAdminMsgContent=a}),98);
__d("MAWWriteThreadPhotoCustomizationAdminMsgContent",["MAWAdminMsgType","MAWCurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a===d("MAWCurrentUser").getID()?d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO:d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO;a=b===d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO?[a]:[];return{adminMsgContent:a,adminType:b,version:1}}g.getAdminMsgContent=a}),98);
__d("MessengerThreadThemeType",[],(function(a,b,c,d,e,f){a=Object.freeze({COLOR_GRADIENT:1,THEME:2,THIRD_PARTY:3,INTERACTIVE:4,IGD_CHANNEL_CUSTOMIZED_THEME:5,AI_AGENT:6,AI_GENERATED_THEME:7,AI_STUDIO_GENERATED_THEME:8,AI_INTERACTIVE_THEME:9});f["default"]=a}),66);
__d("MAWWriteThreadThemeCustomizationAdminMsgContent",["MAWAdminMsgType","MAWCurrentUser","MessengerThreadThemeType","WALogger","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to convert theme type to integer: ",""]);h=function(){return a};return a}function a(a,b,c,e){var f=a===d("MAWCurrentUser").getID();f=i(f,e);e=[];f===d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_THEME||f===d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_AI_THEME?e.push(c):e.push(a,c);b!=null&&e.push(b);return{adminMsgContent:e,adminType:f,version:1}}function i(a,b){if(c("gkx")("11033")&&b!=null)try{b=parseInt(b,10)===c("MessengerThreadThemeType").AI_GENERATED_THEME;if(b)return a?d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_AI_THEME:d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_AI_THEME}catch(a){d("WALogger").ERROR(h(),a)}return a?d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_CUSTOMIZE_THEME:d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_CUSTOMIZE_THEME}g.getAdminMsgContent=a}),98);
__d("MAWWriteUKOSAAdminMsgContent",["MAWAdminMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("MAWAdminMsgType").ADMIN_MSG_TYPE.E2EE_THREAD_UK_OSA_ADMIN_MESSAGE;a=[a];return{adminMsgContent:a,adminType:b,version:1}}g.getAdminMsgContent=a}),98);
__d("MAWWriteUnpinMessageAdminMsgContent",["MAWAdminMsgType","MAWCurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a===d("MAWCurrentUser").getID()?d("MAWAdminMsgType").ADMIN_MSG_TYPE.CURRENT_USER_UNPINNED_MESSAGE:d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_UNPINNED_MESSAGE;a=b===d("MAWAdminMsgType").ADMIN_MSG_TYPE.PARTICIPANT_UNPINNED_MESSAGE?[a]:[];return{adminMsgContent:a,adminType:b,version:1}}g.getAdminMsgContent=a}),98);
__d("MWPMiniSearch",["gkx","minisearch"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=c("gkx")("15701");a=a?{fuzzy:0,prefix:!0}:{fuzzy:.2,prefix:!0};return{fields:["content"],searchOptions:a}}function a(a){a===void 0&&(a=function(){return{}});var b;function d(){b=new(c("minisearch"))(babelHelpers["extends"]({},h(),{},a()))}return{getInstance:function(){b==null&&d();return b}}}g.createMiniSearchSingleton=a}),98);
__d("MpsAdminMsgToBridge",["FBLogger","MAWAckLevel","MAWEphemeralUtils","MAWJids","MAWWritePinMessageAdminMsgContent","MAWWriteThreadHotlikeCustomizationAdminMsgContent","MAWWriteThreadNicknameCustomizationAdminMsgContent","MAWWriteThreadPhotoCustomizationAdminMsgContent","MAWWriteThreadThemeCustomizationAdminMsgContent","MAWWriteUKOSAAdminMsgContent","MAWWriteUnpinMessageAdminMsgContent","WAArmadilloMiTransportAdminMessage.pb","WAMsgType","getErrorSafe","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(b.quickReactionChanged!=null){var e=b.quickReactionChanged.emojiName;return d("MAWWriteThreadHotlikeCustomizationAdminMsgContent").getAdminMsgContent(a,c("nullthrows")(e))}else if(b.iconChanged!=null){e=b.iconChanged.threadIcon;return d("MAWWriteThreadHotlikeCustomizationAdminMsgContent").getAdminMsgContent(a,c("nullthrows")(e))}else if(b.chatThemeChanged!=null){e=b.chatThemeChanged;var f=e.themeEmoji,g=e.themeName;e=e.themeType;return d("MAWWriteThreadThemeCustomizationAdminMsgContent").getAdminMsgContent(a,f,c("nullthrows")(g),""+(e!=null?e:""))}else if(b.messagePinned!=null){f=b.messagePinned.action;g=f===d("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessage$MessagePinned$Action.PINNED?d("MAWWritePinMessageAdminMsgContent").getAdminMsgContent:d("MAWWriteUnpinMessageAdminMsgContent").getAdminMsgContent;return g(a)}else if(b.nicknameChanged!=null){e=b.nicknameChanged;f=e.nickname;g=e.targetUserId;return d("MAWWriteThreadNicknameCustomizationAdminMsgContent").getAdminMsgContent(a,c("nullthrows")(g),c("nullthrows")(f))}else if(((e=b.linkCta)==null?void 0:e.ukOsaAdminText)!=null)return d("MAWWriteUKOSAAdminMsgContent").getAdminMsgContent(c("nullthrows")(b.linkCta.ukOsaAdminText.initiatorUserId));else if(b.disappearingSettingChanged!=null){return d("MAWEphemeralUtils").getEphemeralSettingChangeData(d("MAWJids").toUserJid(a),(f=(g=b.disappearingSettingChanged)==null?void 0:g.disappearingSettingDurationSeconds)!=null?f:0,((g=(e=b.disappearingSettingChanged)==null?void 0:e.oldDisappearingSettingDurationSeconds)!=null?g:0)===0,!1)}else if(b.groupImageChanged!=null)return d("MAWWriteThreadPhotoCustomizationAdminMsgContent").getAdminMsgContent(a)}function a(a){var b;b=(b=a.deserialize().adminMessage())==null?void 0:b.proto;if(b==null)return;var e;try{e=h(a.message.senderId,b)}catch(a){c("FBLogger")("mps").catching(c("getErrorSafe")(a)).warn("Failed to get admin message content")}if(e==null)return;b={ack:d("MAWAckLevel").ACK.received,adminContent:e.adminMsgContent,adminType:e.adminType,adminVersion:e.version,chatJid:a.getChatJid(),externalId:a.getExternalId(),forwardingScore:0,isAdminMessage:!0,isAuthorMe:!1,isForwarded:!1,msgId:a.getMsgId(),sender:a.message.senderId,sortOrderMs:a.message.timestampMs,ts:a.getUnixTs(),type_:d("WAMsgType").MSG_TYPE.ADMIN};return{kind:"bridgeMsg",value:b}}g.adminMsgToBridgeMsg=a}),98);
__d("MpsBumpMessageToBridgeMsg",["MAWAckLevel","MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c,e=a.deserialize().encryptedTransportMessage();b=e==null?void 0:(b=e.armadillo())==null?void 0:(b=b.proto.payload)==null?void 0:(b=b.content)==null?void 0:b.bumpExistingMessage;if(b==null||e==null)return null;e={ack:d("MAWAckLevel").ACK.received,chatJid:a.getChatJid(),externalId:a.getExternalId(),forwardingScore:(c=(c=e.proto.metadata)==null?void 0:c.forwardingScore)!=null?c:0,isAdminMessage:!1,isAuthorMe:a.isAuthorMe(),isForwarded:(e=(c=e.proto.metadata)==null?void 0:c.isForwarded)!=null?e:!1,msgId:a.getMsgId(),replySourceId:(c=b.key)==null?void 0:c.id,sender:a.message.senderId,sortOrderMs:a.message.timestampMs,ts:a.getUnixTs(),type_:d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE};return{kind:"bridgeMsg",value:e}}g.bumpMessageToBridgeMsg=a}),98);
__d("MpsEditToBridge",["LSMessageSendStatus","MAWDbEditMsgHistory","WAJids","WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var e=d("MAWDbEditMsgHistory").convertToEditMsgHistoryId64(d("MAWDbEditMsgHistory").unsafeCoerceToEditMsgHistoryId(Number(a.getExternalId()))),f=a.topLevelMetadata();e={author:a.getAuthor(),editExternalId:d("WAStanzaUtils").toStanzaId(a.getExternalId()),editMsgHistoryId:e,editTs:a.getUnixTs(),msgContent:b,originalMsgExternalId:d("WAStanzaUtils").toStanzaId(f.getExternalId()),originalMsgId:f.getMsgId(),sendStatus:c("LSMessageSendStatus").SENDING_TO_SERVER,threadJid:a.getChatJid()};return{kind:"bridgeEditHistoryMsg",value:e}}function a(a){var b;b=(b=a.deserialize().encryptedTransportMessage())==null?void 0:(b=b.consumerMessage())==null?void 0:(b=b.payload)==null?void 0:(b=b.content)==null?void 0:(b=b.editMessage)==null?void 0:b.message;if(b==null)return;return h(a,{commands:b==null?void 0:b.commands,content:((a=b==null?void 0:b.text)!=null?a:"")+" *",mentionedJids:b==null?void 0:b.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean)})}function b(a){var b,c=a.message,d=a.supplementals,e=a.topLevel;if(e.kind!=="bridgeMsg")return a;var f=d.map(function(a){return a.kind==="bridgeEditHistoryMsg"?a.value:null}).filter(Boolean).sort(function(a,b){return b.editTs-a.editTs});if(f.length===0)return a;d.push(h(c,{commands:e.value.commands&&[].concat(e.value.commands),content:(a=e.value.content)!=null?a:"",mentionedJids:e.value.mentionedJids&&[].concat(e.value.mentionedJids)}));a=f[0].msgContent;e.value=babelHelpers["extends"]({},e.value,{commands:(b=a.commands)!=null?b:e.value.commands,content:(b=a.content)!=null?b:e.value.content,editCount:f.length,mentionedJids:(b=a.mentionedJids)!=null?b:e.value.mentionedJids});return{message:c,supplementals:d,topLevel:e}}g.editMessageToBridgeMsg=a;g.processEditedMessage=b}),98);
__d("MpsEphemeralMessageToBridge",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c=a.message,e=a.supplementals,f=a.topLevel;b=(b=a.message.deserialize().encryptedTransportMessage())==null?void 0:(b=b.proto.metadata)==null?void 0:(b=b.chatEphemeralSetting)==null?void 0:b.ephemeralExpiration;if(b==null||b===0)return a;var g=d("WATimeUtils").castToUnixTime(a.message.getUnixTs()+b),h=d("WATimeUtils").cappedMillisecondsUntil(g);if(h<=0)return a;f.kind==="bridgeMsg"&&(f.value=babelHelpers["extends"]({},f.value,{ephemeralDurationInSec:b}));a.supplementals.push({kind:"bridgeMsgsStartCountdown",value:{msgs:[{countdownTs:g,millisecondsUntilCountdownTs:h,msgId:a.message.getMsgId(),threadJid:a.message.getChatJid(),ts:a.message.getUnixTs()}]}});return{message:c,supplementals:e,topLevel:f}}g.processEphemeralMessage=a}),98);
__d("MpsMediaToBridge",["FBLogger","MAWAckLevel","MAWDbMedia","MAWMsgType","WAHashUtils","WALongInt","WATimeUtils","getMediaTypeFromConsumerMessage"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=(a=a.encryptedTransportMessage())==null?void 0:(a=a.consumerMessage())==null?void 0:a.proto;a=d("getMediaTypeFromConsumerMessage").getMediaTypeFromConsumerMessage(a);if(a==null)return;switch(a){case"ptt":return d("MAWMsgType").MSG_TYPE.PTT;case"image":return d("MAWMsgType").MSG_TYPE.IMAGE;case"video":return d("MAWMsgType").MSG_TYPE.VIDEO;case"gif":return d("MAWMsgType").MSG_TYPE.GIF;case"sticker":return d("MAWMsgType").MSG_TYPE.STICKER;case"document":return d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE;case"xma-image":return;case"md-app-state":return;default:return a}}function a(a){var b,c=a.deserialize().encryptedTransportMessage();if(c==null)return;var e=h(a.deserialize());if(e==null)return;b={ack:d("MAWAckLevel").ACK.received,chatJid:a.getChatJid(),externalId:a.getExternalId(),forwardingScore:(b=(b=c.proto.metadata)==null?void 0:b.forwardingScore)!=null?b:0,groupId:(b=c.proto.metadata)==null?void 0:b.groupId,groupIndex:(b=c.proto.metadata)==null?void 0:b.groupIndex,groupSize:(b=c.proto.metadata)==null?void 0:b.groupSize,isAdminMessage:!1,isAuthorMe:a.isAuthorMe(),isForwarded:(c=(b=c.proto.metadata)==null?void 0:b.isForwarded)!=null?c:!1,msgId:a.getMsgId(),sender:a.message.senderId,sortOrderMs:a.message.timestampMs,ts:a.getUnixTs(),type_:e};return{kind:"bridgeMsg",value:b}}function b(a){var b,e,f,g,i;b=(b=a.message.deserialize().encryptedTransportMessage())==null?void 0:b.consumerMessage();if(b==null)return a;e=(e=b.documentMessage())==null?void 0:e.fileName;f=(f=(f=(f=(f=(f=(f=b.audioMessage())==null?void 0:f.payload)!=null?f:(f=b.documentMessage())==null?void 0:f.payload)!=null?f:(f=b.imageMessage())==null?void 0:f.payload)!=null?f:(f=b.stickerMessage())==null?void 0:f.payload)!=null?f:(f=b.videoMessage())==null?void 0:f.payload)!=null?f:{};var j=f.ancillary;f=f.integral;if((j==null?void 0:j.receiverFetchId)!=null||(f==null?void 0:f.receiverFetchId)!=null)return a;var k=h(a.message.deserialize());if(k==null||j==null||f==null){k==null&&(j!=null||f!=null)&&c("FBLogger")("mps").mustfix("media type is null but ancillary or integral is not: %s",a.topLevel.kind);return a}var l=a.message.getMsgId();g=f==null?void 0:(g=f.transport)==null?void 0:(g=g.integral)==null?void 0:g.mediaKeyTimestamp;i=f==null?void 0:(i=f.transport)==null?void 0:(i=i.integral)==null?void 0:i.fileSha256;i=i!=null?d("WAHashUtils").toPlaintextHash(i):void 0;k={accessibilitySummaryText:(b=(b=b.imageMessage())==null?void 0:(b=b.caption)==null?void 0:b.text)!=null?b:(b=j.caption)==null?void 0:b.text,defaultFilename:e,duration:((b=j.seconds)!=null?b:0)*1e3,filenames:e!=null?(b={},b[l]=e,b):void 0,filesize:d("WALongInt").numberOrThrowIfTooLarge((e=f==null?void 0:(e=f.transport)==null?void 0:(b=e.ancillary)==null?void 0:b.fileLength)!=null?e:0),hasMedia:!0,hasPreviewMedia:(f==null?void 0:(b=f.transport)==null?void 0:(e=b.ancillary)==null?void 0:e.thumbnail)!=null,mediaId:d("MAWDbMedia").convertNumberToMediaId(0),mediaType:k,messagesSortOrderMs:(b={},b[l]=a.message.topLevel.timestampMs,b),msgIds:[a.message.getMsgId()],offlineAttachmentId:i,plaintextHash:i,previewHeight:f==null?void 0:(e=f.transport)==null?void 0:(k=e.ancillary)==null?void 0:(l=k.thumbnail)==null?void 0:l.thumbnailHeight,previewHeightLarge:j==null?void 0:j.height,previewWidth:f==null?void 0:(b=f.transport)==null?void 0:(i=b.ancillary)==null?void 0:(e=i.thumbnail)==null?void 0:e.thumbnailWidth,previewWidthLarge:j==null?void 0:j.width,sortOrderMs:g!=null?d("WATimeUtils").castLongIntToMillisTime(g):void 0,threadJid:a.message.getChatJid(),transportKey:"WhatsApp",ts:a.message.getUnixTs()};a.supplementals.push({kind:"bridgeMedia",value:k});return a}g.getMediaTypeForMedia=h;g.mediaToBridge=a;g.processAttachment=b}),98);
__d("mwv2MessageIsEmojiOnly",["EmojiRenderer","EmoticonRenderer","ReStoreVaulting"],(function(a,b,c,d,e,f,g){"use strict";var h=/^[ \r\n\s]*$/;function a(a,b){if(a==null)return!1;var c=d("ReStoreVaulting").maybeUnvault(a);a=d("EmojiRenderer").parse(c).map(function(a){return{length:a.length,offset:a.offset}});b=b?d("EmoticonRenderer").parse(c).map(function(a){return{length:a.chars.length,offset:a.offset}}):[];a=a.concat(b);if(a.length===0)return!1;b=a.sort(function(a,b){return a.offset-b.offset|0});var e={contents:0},f={contents:0};a=b.some(function(a){e.contents===a.offset?(e.contents=e.contents+a.length|0,f.contents=e.contents):f.contents=a.offset;var b=c.substring(e.contents,f.contents);e.contents=a.offset+a.length|0;return h.test(b)===!1});b=e.contents!==c.length&&!h.test(c.substring(f.contents));if(a)return!1;else return!b}g["default"]=a}),98);
__d("MpsMessageTextToBridge",["MAWAckLevel","MAWVault","WAJids","WAMsgType","maybeConvertMessageTextMentionsV2ToV1","mwv2MessageIsEmojiOnly"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,e,f=a.deserialize().encryptedTransportMessage(),g=f==null?void 0:f.consumerMessage();b=c("maybeConvertMessageTextMentionsV2ToV1")(g==null?void 0:(b=g.payload)==null?void 0:(b=b.content)==null?void 0:b.messageText);if(g==null||b==null||f==null)return;e=(e=b.text)!=null?e:"";var h=c("mwv2MessageIsEmojiOnly")(e,!0);h||(e+="*");e=d("MAWVault").vault(e);e={ack:d("MAWAckLevel").ACK.received,chatJid:a.getChatJid(),commands:b.commands,content:e,externalId:a.getExternalId(),forwardingScore:(e=(h=f.proto.metadata)==null?void 0:h.forwardingScore)!=null?e:0,isAdminMessage:!1,isAuthorMe:a.isAuthorMe(),isForwarded:(e=(h=f.proto.metadata)==null?void 0:h.isForwarded)!=null?e:!1,mentionedJids:b.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean),msgId:a.getMsgId(),sender:a.message.senderId,sortOrderMs:a.message.timestampMs,specialTextSize:(h=(f=g.metadata)==null?void 0:f.specialTextSize)!=null?h:void 0,ts:a.getUnixTs(),type_:d("WAMsgType").MSG_TYPE.TEXT};return{kind:"bridgeMsg",value:e}}g.messageTextToBridgeMsg=a}),98);
__d("MpsReactionToBridge",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;b=(b=a.deserialize().encryptedTransportMessage())==null?void 0:(b=b.consumerMessage())==null?void 0:(b=b.payload)==null?void 0:(b=b.content)==null?void 0:b.reactionMessage;if(b==null)return;b={reaction:{actorId:a.message.senderId,chatJid:a.getChatJid(),messageId:a.topLevelMetadata().getMsgId(),reaction:(b=b.text)!=null?b:"",ts:a.topLevelMetadata().getUnixTs()},type:"upsert"};return{kind:"bridgeReactionAction",value:b}}f.reactionMessageToBridgeMsg=a}),66);
__d("MpsReceiverFetchInfoToBridge",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c,e;b=(b=a.message.deserialize().encryptedTransportMessage())==null?void 0:b.consumerMessage();if(b==null)return a;b=(b=(b=b.stickerMessage())==null?void 0:b.payload)!=null?b:{};var f=b.ancillary;b=b.integral;c=(c=b==null?void 0:b.receiverFetchId)!=null?c:f==null?void 0:f.receiverFetchId;b=b==null?void 0:(b=b.transport)==null?void 0:(b=b.ancillary)==null?void 0:b.mimetype;if(c==null||b==null)return a;e=(e=f==null?void 0:f.width)!=null?e:0;f=(f=f==null?void 0:f.height)!=null?f:0;b={mimetype:b,msgId:a.message.getMsgId(),previewHeight:f,previewWidth:e,receiverFetchId:c,sortOrderMs:d("WATimeUtils").castLongIntToMillisTime(a.message.message.timestampMs),threadJid:a.message.getChatJid(),transportKey:"WhatsApp",type:"sticker"};a.supplementals.push({kind:"bridgeReceiverFetchInfo",value:b});return a}g.processReceiverFetchInfo=a}),98);
__d("MpsReplyToBridge",["WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.message,c=a.supplementals,e=a.topLevel,f=b.deserialize().encryptedTransportMessage();if(e.kind!=="bridgeMsg"||f==null)return a;f=(f=f.proto.metadata)==null?void 0:f.quotedMessage;if(f==null)return a;a=f.participant!=null?d("WAJids").validateUserJid(f==null?void 0:f.participant):null;a=a!=null?d("WAJids").userIdFromJid(a):void 0;e.value=babelHelpers["extends"]({},e.value,{replySourceId:f==null?void 0:f.stanzaId,replyToUserId:a});return{message:b,supplementals:c,topLevel:e}}g.processReplyMessage=a}),98);
__d("MpsRevokeMessageToBridgeMsg",["MAWAckLevel","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c=a.deserialize().encryptedTransportMessage();b=c==null?void 0:(b=c.consumerMessage())==null?void 0:(b=b.payload)==null?void 0:(b=b.applicationData)==null?void 0:b.revoke;if(c==null||b==null)return;return{kind:"bridgeMsg",value:{ack:d("MAWAckLevel").ACK.received,chatJid:a.getChatJid(),externalId:a.getExternalId(),forwardingScore:(b=(b=c.proto.metadata)==null?void 0:b.forwardingScore)!=null?b:0,isAdminMessage:!1,isAuthorMe:a.isAuthorMe(),isForwarded:(c=(b=c.proto.metadata)==null?void 0:b.isForwarded)!=null?c:!1,msgId:a.getMsgId(),sender:a.message.senderId,sortOrderMs:a.message.timestampMs,ts:a.getUnixTs(),type_:d("WAMsgType").MSG_TYPE.REVOKED}}}g.revokeMessageToBridgeMsg=a}),98);
__d("MpsScreenshotActionToBridgeMsg",["MAWAckLevel","MAWEphemeralUtils","WAArmadilloApplication.pb","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c=a.deserialize().encryptedTransportMessage();b=c==null?void 0:(b=c.armadillo())==null?void 0:(b=b.proto.payload)==null?void 0:(b=b.content)==null?void 0:b.screenshotAction;if(b==null||c==null)return;b=d("MAWEphemeralUtils").getEphemeralScreenshotActionData((c=b.screenshotType)!=null?c:d("WAArmadilloApplication.pb").ARMADILLO_CONTENT_SCREENSHOT_ACTION_SCREENSHOT_TYPE.SCREENSHOT_IMAGE,a.getSenderJid(),a.isAuthorMe());c={ack:d("MAWAckLevel").ACK.received,adminContent:b.ephemeralScreenshotActionContent,adminType:b.ephemeralScreenshotActionType,adminVersion:1,chatJid:a.getChatJid(),externalId:a.getExternalId(),forwardingScore:0,isAdminMessage:!0,isAuthorMe:a.isAuthorMe(),isForwarded:!1,msgId:a.getMsgId(),sender:a.message.senderId,sortOrderMs:a.message.timestampMs,ts:a.getUnixTs(),type_:d("WAMsgType").MSG_TYPE.ADMIN};return{kind:"bridgeMsg",value:c}}g.screenshotActionToBridgeMsg=a}),98);
__d("MpsMessageToBridge",["MpsAdminMsgToBridge","MpsBumpMessageToBridgeMsg","MpsEditToBridge","MpsEphemeralMessageToBridge","MpsMediaToBridge","MpsMessageTextToBridge","MpsMessageToBridgeWrapper","MpsReactionToBridge","MpsReceiverFetchInfoToBridge","MpsReplyToBridge","MpsRevokeMessageToBridgeMsg","MpsScreenshotActionToBridgeMsg"],(function(a,b,c,d,e,f,g){"use strict";var h=[d("MpsMessageTextToBridge").messageTextToBridgeMsg,d("MpsEditToBridge").editMessageToBridgeMsg,d("MpsReactionToBridge").reactionMessageToBridgeMsg,d("MpsMediaToBridge").mediaToBridge,d("MpsAdminMsgToBridge").adminMsgToBridgeMsg,d("MpsScreenshotActionToBridgeMsg").screenshotActionToBridgeMsg,d("MpsRevokeMessageToBridgeMsg").revokeMessageToBridgeMsg,d("MpsBumpMessageToBridgeMsg").bumpMessageToBridgeMsg],i=[d("MpsEditToBridge").processEditedMessage,d("MpsReplyToBridge").processReplyMessage,d("MpsMediaToBridge").processAttachment,d("MpsEphemeralMessageToBridge").processEphemeralMessage,d("MpsReceiverFetchInfoToBridge").processReceiverFetchInfo];function j(a){for(var b of h){var c=b(a);if(c!=null)return c}}function a(a){var b=d("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromTopLevel(a.toplevelProtobuf),c=j(b);if(c==null)return;var e=a.supplementalProtobufs.values().toArray().map(function(b){return j(d("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromSupplemental(b,a.toplevelProtobuf))}).filter(Boolean);b=i.reduce(function(a,b){return b(a)},{message:b,supplementals:e,topLevel:c});return{supplementals:b.supplementals,topLevel:b.topLevel}}g.mpsFullMessagetoBridge=a}),98);
__d("OfflineThreadingId",["I64","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("I64"))).of_string("4194303");function a(){return(h||(h=d("I64"))).to_string(j())}function j(){var a=d("XPlatReactCrypto").getRandomValues(new Uint8Array(8));a=new DataView(a.buffer);a=(h||(h=d("I64"))).add(h.lsl_(h.of_int32(a.getUint32(0)),32),h.of_int32(a.getUint32(4)));return k(Date.now(),a)}function k(a,b){return(h||(h=d("I64"))).and_(h.or_(h.lsl_(h.of_float(a),22),h.and_(b,i)),h.max_int)}function b(a){var b=j(),c=[];for(var e=0;e<a.length;e++)c.push([a[e],(h||(h=d("I64"))).to_string(b)]),b=l(b);return c}function l(a,b){b===void 0&&(b=(h||(h=d("I64"))).one);var c=m(a);a=n(a);return k(c,(h||(h=d("I64"))).add(a,b))}function m(a){return(h||(h=d("I64"))).to_float(h.lsr_(a,22))}function n(a){return(h||(h=d("I64"))).and_(a,i)}g.createOfflineThreadingID=a;g.createForItemsInOrder=b;g.extractTimestamp=m}),98);
__d("isEbEnabledWithIGDEligibilityCheck",["EBIsEbEnabled","Promise","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return!c("gkx")("23914")?(h||(h=b("Promise"))).resolve(!1):d("EBIsEbEnabled").isEbEnabledLS(a.tables)}g.isEbEnabledWithIGDEligibilityCheck=a}),98);
__d("isMAWUniversalSearchWithEBEnabled",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("4741")}g["default"]=a}),98);